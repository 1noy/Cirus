import{u as e,a as r,j as t}from"./index-Brw_O7UB.js";import{r as a}from"./react-core-Bb0gnVVB.js";import{e as o,d as i,s as n,u as l}from"./firebase-firestore-B0lvOGz2.js";import{a as s,d}from"./firebase-Cc3EvCVe.js";import{u as p}from"./router-Db56Mi_u.js";import"./mui-eVobQS_6.js";import"./emotion-BB-a1p0A.js";import"./firebase-auth-DogJ4AYO.js";import"./firebase-storage-r8t-BqtU.js";var g=Object.defineProperty,c=Object.defineProperties,f=Object.getOwnPropertyDescriptors,b=Object.getOwnPropertySymbols,x=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,y=(e,r,t)=>r in e?g(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t,h=(e,r)=>{for(var t in r||(r={}))x.call(r,t)&&y(e,t,r[t]);if(b)for(var t of b(r))u.call(r,t)&&y(e,t,r[t]);return e},m=(e,r)=>c(e,f(r)),v=(e,r,t)=>new Promise((a,o)=>{var i=e=>{try{l(t.next(e))}catch(r){o(r)}},n=e=>{try{l(t.throw(e))}catch(r){o(r)}},l=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,n);l((t=t.apply(e,r)).next())});function S(){const[g,c]=a.useState({displayName:"",email:"",avatar:"",bio:"",phone:"",location:"",website:""}),[f,b]=a.useState(!0),[x,u]=a.useState(!1),[y,S]=a.useState(!1),[w,k]=a.useState(""),[C,z]=a.useState(!0),j=p(),{showToast:R}=e(),B=a.useCallback(()=>v(this,null,function*(){if(C)try{const e=yield o(i(d,"users",s.currentUser.uid));if(e.exists()){const r=e.data();C&&c({displayName:r.displayName||"",email:s.currentUser.email||"",avatar:r.avatar||"",bio:r.bio||"",phone:r.phone||"",location:r.location||"",website:r.website||""})}else yield n(i(d,"users",s.currentUser.uid),{displayName:s.currentUser.displayName||"",email:s.currentUser.email,avatar:"",bio:"",phone:"",location:"",website:"",createdAt:(new Date).toISOString(),online:!0}),C&&c({displayName:s.currentUser.displayName||"",email:s.currentUser.email||"",avatar:"",bio:"",phone:"",location:"",website:""})}catch(e){C&&R({message:"Erreur lors du chargement du profil",severity:"error"})}finally{C&&b(!1)}}),[R,C]);a.useEffect(()=>{if(z(!0),s.currentUser)return B(),()=>{z(!1)};j("/login")},[j,B]);const W=e=>v(this,null,function*(){if(e.preventDefault(),!s.currentUser)return R({message:"Session expirée, reconnexion requise.",severity:"error"}),void j("/login");if(g.displayName.trim()){u(!0);try{yield l(i(d,"users",s.currentUser.uid),{displayName:g.displayName.trim(),avatar:g.avatar,bio:g.bio.trim(),phone:g.phone.trim(),location:g.location.trim(),website:g.website.trim(),updatedAt:(new Date).toISOString()}),R({message:"Profil mis à jour avec succès !",severity:"success"})}catch(r){R({message:"Erreur lors de la mise à jour du profil",severity:"error"})}finally{u(!1)}}else R({message:"Le nom ne peut pas être vide",severity:"error"})});return f?r("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #23234a 0%, #181828 100%)",color:"#3ef2ff"},children:t("div",{style:{textAlign:"center"},children:[r("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"⏳"}),"Chargement..."]})}):t("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #23234a 0%, #181828 100%)",color:"#fff",padding:"20px"},children:[t("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px",padding:"20px",background:"rgba(28, 198, 255, 0.1)",borderRadius:"16px",border:"1px solid rgba(62, 242, 255, 0.2)",backdropFilter:"blur(10px)"},children:[r("h1",{style:{margin:0,fontSize:"28px",fontWeight:"bold",background:"linear-gradient(90deg, #3ef2ff 0%, #1cc6ff 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Mon Profil"}),t("div",{style:{display:"flex",gap:"12px"},children:[r("button",{onClick:()=>j("/chat"),style:{padding:"10px 20px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.3s ease"},onMouseEnter:e=>{e.target.style.background="rgba(255, 255, 255, 0.15)"},onMouseLeave:e=>{e.target.style.background="rgba(255, 255, 255, 0.1)"},children:"Retour au Chat"}),r("button",{onClick:()=>v(this,null,function*(){try{yield s.signOut(),j("/"),R({message:"Déconnexion réussie",severity:"success"})}catch(e){R({message:"Erreur lors de la déconnexion",severity:"error"})}}),style:{padding:"10px 20px",background:"linear-gradient(90deg, #ff4757 0%, #ff3742 100%)",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(255, 71, 87, 0.3)"},onMouseEnter:e=>{e.target.style.transform="translateY(-1px)",e.target.style.boxShadow="0 4px 12px rgba(255, 71, 87, 0.4)"},onMouseLeave:e=>{e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 2px 8px rgba(255, 71, 87, 0.3)"},children:"Déconnexion"})]})]}),t("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:"32px",maxWidth:"1200px",margin:"0 auto"},children:[t("div",{style:{background:"rgba(28, 198, 255, 0.05)",borderRadius:"16px",padding:"24px",border:"1px solid rgba(62, 242, 255, 0.2)",height:"fit-content"},children:[r("h3",{style:{margin:"0 0 20px 0",fontSize:"20px",fontWeight:"bold",color:"#3ef2ff"},children:"Avatar"}),t("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"16px"},children:[r("div",{style:{width:"120px",height:"120px",borderRadius:"50%",background:g.avatar||"linear-gradient(135deg, #1cc6ff 0%, #009fff 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"48px",fontWeight:"bold",color:"#fff",boxShadow:"0 4px 16px rgba(28, 198, 255, 0.3)",border:"3px solid rgba(62, 242, 255, 0.3)",overflow:"hidden"},children:g.avatar?r("img",{src:g.avatar,alt:"Avatar",style:{width:"100%",height:"100%",objectFit:"cover"}}):g.displayName.charAt(0).toUpperCase()}),r("button",{onClick:()=>S(!0),style:{padding:"10px 20px",background:"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(28, 198, 255, 0.3)"},onMouseEnter:e=>{e.target.style.transform="translateY(-1px)",e.target.style.boxShadow="0 4px 12px rgba(28, 198, 255, 0.4)"},onMouseLeave:e=>{e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 2px 8px rgba(28, 198, 255, 0.3)"},children:"Changer l'avatar"})]})]}),t("div",{style:{background:"rgba(28, 198, 255, 0.05)",borderRadius:"16px",padding:"24px",border:"1px solid rgba(62, 242, 255, 0.2)"},children:[r("h3",{style:{margin:"0 0 24px 0",fontSize:"20px",fontWeight:"bold",color:"#3ef2ff"},children:"Informations Personnelles"}),t("form",{onSubmit:W,style:{display:"flex",flexDirection:"column",gap:"16px"},children:[t("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[t("div",{children:[r("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#a0f0ff"},children:"Nom d'affichage *"}),r("input",{type:"text",value:g.displayName,onChange:e=>c(m(h({},g),{displayName:e.target.value})),placeholder:"Votre nom",style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"8px",color:"#fff",fontSize:"14px",transition:"all 0.3s ease",outline:"none"},onFocus:e=>{e.target.style.border="1px solid rgba(62, 242, 255, 0.6)",e.target.style.boxShadow="0 0 0 3px rgba(62, 242, 255, 0.1)"},onBlur:e=>{e.target.style.border="1px solid rgba(62, 242, 255, 0.3)",e.target.style.boxShadow="none"},maxLength:32,required:!0})]}),t("div",{children:[r("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#a0f0ff"},children:"Email"}),r("input",{type:"email",value:g.email,disabled:!0,style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(62, 242, 255, 0.2)",borderRadius:"8px",color:"#a0f0ff",fontSize:"14px",opacity:.7}})]})]}),t("div",{children:[r("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#a0f0ff"},children:"Bio"}),r("textarea",{value:g.bio,onChange:e=>c(m(h({},g),{bio:e.target.value})),placeholder:"Parle de toi...",rows:3,style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"8px",color:"#fff",fontSize:"14px",transition:"all 0.3s ease",outline:"none",resize:"vertical",fontFamily:"inherit"},onFocus:e=>{e.target.style.border="1px solid rgba(62, 242, 255, 0.6)",e.target.style.boxShadow="0 0 0 3px rgba(62, 242, 255, 0.1)"},onBlur:e=>{e.target.style.border="1px solid rgba(62, 242, 255, 0.3)",e.target.style.boxShadow="none"},maxLength:200})]}),t("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[t("div",{children:[r("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#a0f0ff"},children:"Téléphone"}),r("input",{type:"tel",value:g.phone,onChange:e=>c(m(h({},g),{phone:e.target.value})),placeholder:"Votre numéro",style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"8px",color:"#fff",fontSize:"14px",transition:"all 0.3s ease",outline:"none"},onFocus:e=>{e.target.style.border="1px solid rgba(62, 242, 255, 0.6)",e.target.style.boxShadow="0 0 0 3px rgba(62, 242, 255, 0.1)"},onBlur:e=>{e.target.style.border="1px solid rgba(62, 242, 255, 0.3)",e.target.style.boxShadow="none"}})]}),t("div",{children:[r("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#a0f0ff"},children:"Localisation"}),r("input",{type:"text",value:g.location,onChange:e=>c(m(h({},g),{location:e.target.value})),placeholder:"Votre ville",style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"8px",color:"#fff",fontSize:"14px",transition:"all 0.3s ease",outline:"none"},onFocus:e=>{e.target.style.border="1px solid rgba(62, 242, 255, 0.6)",e.target.style.boxShadow="0 0 0 3px rgba(62, 242, 255, 0.1)"},onBlur:e=>{e.target.style.border="1px solid rgba(62, 242, 255, 0.3)",e.target.style.boxShadow="none"}})]})]}),t("div",{children:[r("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#a0f0ff"},children:"Site web"}),r("input",{type:"url",value:g.website,onChange:e=>c(m(h({},g),{website:e.target.value})),placeholder:"https://votre-site.com",style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"8px",color:"#fff",fontSize:"14px",transition:"all 0.3s ease",outline:"none"},onFocus:e=>{e.target.style.border="1px solid rgba(62, 242, 255, 0.6)",e.target.style.boxShadow="0 0 0 3px rgba(62, 242, 255, 0.1)"},onBlur:e=>{e.target.style.border="1px solid rgba(62, 242, 255, 0.3)",e.target.style.boxShadow="none"}})]}),t("div",{style:{display:"flex",gap:"12px",marginTop:"16px"},children:[r("button",{type:"button",onClick:W,disabled:x,"aria-label":"Sauvegarder le profil",role:"button",tabIndex:0,style:{flex:1,padding:"14px 24px",border:"none",borderRadius:"8px",background:"linear-gradient(135deg, #1cc6ff 0%, #009fff 100%)",color:"#fff",fontSize:"16px",fontWeight:"600",cursor:x?"not-allowed":"pointer",transition:"all 0.2s ease",opacity:x?.7:1},onMouseEnter:e=>{x||(e.target.style.transform="translateY(-1px)",e.target.style.boxShadow="0 4px 12px rgba(28, 198, 255, 0.3)")},onMouseLeave:e=>{e.target.style.transform="translateY(0)",e.target.style.boxShadow="none"},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||x||(e.preventDefault(),W())},children:x?t("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[r("div",{style:{width:"16px",height:"16px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTop:"2px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite"}}),"Sauvegarde..."]}):"Sauvegarder"}),r("button",{type:"button",onClick:()=>j("/chat"),"aria-label":"Retourner au chat",role:"button",tabIndex:0,style:{flex:1,padding:"14px 24px",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",background:"rgba(255, 255, 255, 0.1)",color:"#fff",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:e=>{e.target.style.background="rgba(255, 255, 255, 0.2)",e.target.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.target.style.background="rgba(255, 255, 255, 0.1)",e.target.style.transform="translateY(0)"},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),j("/chat"))},children:"Retour au chat"})]})]})]})]}),y&&r("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(5px)"},children:t("div",{style:{background:"linear-gradient(135deg, #23234a 0%, #181828 100%)",padding:"28px",borderRadius:"16px",width:"500px",border:"1px solid rgba(62, 242, 255, 0.3)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},children:[r("h3",{style:{margin:"0 0 20px 0",fontSize:"20px",fontWeight:"bold",color:"#3ef2ff"},children:"Choisir un avatar"}),r("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px",marginBottom:"20px"},children:["https://api.dicebear.com/7.x/avataaars/svg?seed=Felix","https://api.dicebear.com/7.x/avataaars/svg?seed=Aneka","https://api.dicebear.com/7.x/avataaars/svg?seed=Jasper","https://api.dicebear.com/7.x/avataaars/svg?seed=Lily","https://api.dicebear.com/7.x/avataaars/svg?seed=Max","https://api.dicebear.com/7.x/avataaars/svg?seed=Zoe"].map((e,t)=>r("div",{onClick:()=>k(e),style:{width:"80px",height:"80px",borderRadius:"50%",background:"linear-gradient(135deg, #1cc6ff 0%, #009fff 100%)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",border:w===e?"3px solid #3ef2ff":"2px solid rgba(62, 242, 255, 0.3)",transition:"all 0.3s ease",overflow:"hidden"},onMouseEnter:e=>{e.target.style.transform="scale(1.05)"},onMouseLeave:e=>{e.target.style.transform="scale(1)"},children:r("img",{src:e,alt:`Avatar ${t+1}`,style:{width:"100%",height:"100%",objectFit:"cover"}})},t))}),t("div",{style:{display:"flex",gap:"12px"},children:[r("button",{onClick:()=>{w&&(c(m(h({},g),{avatar:w})),S(!1),k(""))},disabled:!w,style:{flex:1,padding:"12px 20px",background:"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)",border:"none",borderRadius:"8px",color:"#fff",cursor:w?"pointer":"not-allowed",fontSize:"14px",fontWeight:"600",opacity:w?1:.6,transition:"all 0.3s ease"},children:"Confirmer"}),r("button",{onClick:()=>{S(!1),k("")},style:{flex:1,padding:"12px 20px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.3s ease"},children:"Annuler"})]})]})})]})}export{S as default};
