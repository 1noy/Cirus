var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,l=(a,t,s)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s;import{r as o}from"./vendor-Be9Gvr8Z.js";import{d as n,u as c,j as d,a as u,g as m}from"./index-DcW9jZ1P.js";import{f as p,D as h,s as v,H as b,I as j,J as f}from"./firebase-DLJYeIMi.js";import{u as y}from"./router-WS_FqKV8.js";import"./query-BCFsIYE1.js";import"./virtual-BJqExeNh.js";import"./utils-CkSu2hCt.js";import"./error-BaU7SGNY.js";import"./toast-DAwFn72h.js";import"./state-CH3XQ_Yu.js";const x=e=>{return o=function*(){if(!(null==e?void 0:e.uid))return;const o=p(n,"users",e.uid),c=yield h(o),d={uid:e.uid,email:e.email||null,displayName:e.displayName||"Utilisateur",photoURL:e.photoURL||null,updatedAt:Date.now()};var u,m;c.exists()?yield v(o,d,{merge:!0}):yield v(o,(u=((e,a)=>{for(var t in a||(a={}))i.call(a,t)&&l(e,t,a[t]);if(s)for(var t of s(a))r.call(a,t)&&l(e,t,a[t]);return e})({},d),m={createdAt:Date.now()},a(u,t(m))))},new Promise((e,a)=>{var t=e=>{try{i(o.next(e))}catch(t){a(t)}},s=e=>{try{i(o.throw(e))}catch(t){a(t)}},i=a=>a.done?e(a.value):Promise.resolve(a.value).then(t,s);i((o=o.apply(undefined,null)).next())});var o};var g=(e,a,t)=>new Promise((s,i)=>{var r=e=>{try{o(t.next(e))}catch(a){i(a)}},l=e=>{try{o(t.throw(e))}catch(a){i(a)}},o=e=>e.done?s(e.value):Promise.resolve(e.value).then(r,l);o((t=t.apply(e,a)).next())});const N=()=>{const e=y(),{setUser:a}=c(),[t,s]=o.useState("login"),[i,r]=o.useState(""),[l,n]=o.useState(""),[p,h]=o.useState(!1),[v,N]=o.useState("");return d.jsx("div",{className:"facebook-auth-page",children:d.jsxs("div",{className:"facebook-auth-container",children:[d.jsxs("div",{className:"facebook-hero",children:[d.jsx("h1",{className:"facebook-logo",children:"ciruschat"}),d.jsx("h2",{children:"Connectez-vous pour rester en contact avec vos amis et communautés."})]}),d.jsxs("div",{className:"facebook-form-container",children:[d.jsxs("div",{className:"auth-tabs",role:"tablist","aria-label":"Modes d'authentification",children:[d.jsx("button",{className:"auth-tab "+("login"===t?"active":""),onClick:()=>s("login"),role:"tab","aria-selected":"login"===t,children:"Connexion"}),d.jsx("button",{className:"auth-tab "+("register"===t?"active":""),onClick:()=>s("register"),role:"tab","aria-selected":"register"===t,children:"Inscription"})]}),d.jsxs("form",{className:"facebook-form",onSubmit:s=>g(void 0,null,function*(){s.preventDefault(),h(!0),N("");try{if("login"===t){const{user:e}=yield j(u,i,l);a({uid:e.uid,email:e.email,displayName:e.displayName||"Utilisateur",photoURL:e.photoURL||null}),yield x(e)}else{const{user:e}=yield f(u,i,l);a({uid:e.uid,email:e.email,displayName:e.displayName||"Utilisateur",photoURL:e.photoURL||null}),yield x(e)}e("/")}catch(r){N("Échec de l'authentification")}finally{h(!1)}}),children:[d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"email",children:"Adresse e-mail"}),d.jsx("div",{className:"form-input",children:d.jsx("input",{id:"email",type:"email",value:i,onChange:e=>r(e.target.value),placeholder:"email@exemple.com",required:!0})})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"password",children:"Mot de passe"}),d.jsx("div",{className:"form-input password-input",children:d.jsx("input",{id:"password",type:"password",value:l,onChange:e=>n(e.target.value),placeholder:"Votre mot de passe",required:!0})})]}),v&&d.jsx("div",{className:"error-text",role:"alert",children:v}),d.jsxs("div",{className:"auth-actions",children:[d.jsx("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?"Chargement…":"login"===t?"Se connecter":"Créer un compte"}),d.jsx("div",{className:"divider",children:d.jsx("span",{children:"ou"})}),d.jsxs("button",{type:"button",className:"btn btn-google",onClick:()=>g(void 0,null,function*(){h(!0),N("");try{const{user:t}=yield b(u,m);a({uid:t.uid,email:t.email,displayName:t.displayName||"Utilisateur",photoURL:t.photoURL||null}),yield x(t),e("/")}catch(t){N("Google Sign-in échoué")}finally{h(!1)}}),disabled:p,children:[d.jsx("i",{className:"fab fa-google"}),"Continuer avec Google"]})]})]}),d.jsx("a",{className:"forgot-link",href:"#",children:"Mot de passe oublié ?"})]})]})})};export{N as default};
