import{r as et,a as tt,g as nt}from"./vendor-DavUf6mE.js";import{u as se,r as g,B as rt,R as We,a as ot,b as K,N as st}from"./router-DQ-MWp40.js";import{_ as it,C as at,r as ye,S as lt,a as dt,F as ct,g as Ue,b as ie,c as ut,d as pt,i as De,p as ft,u as gt,e as ht,f as xt,h as bt,j as mt,k as yt,G as wt,s as vt,l as re,m as H,n as St,o as kt,q as Rt,t as M,v as B,w as P,x as we,y as V,z as ze,A as q,B as oe,D as jt,E as _t}from"./firebase-BLLaeY4X.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var de={exports:{}},J={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ve;function Et(){if(ve)return J;ve=1;var e=et(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function l(f,d,b){var x,w={},m=null,S=null;b!==void 0&&(m=""+b),d.key!==void 0&&(m=""+d.key),d.ref!==void 0&&(S=d.ref);for(x in d)o.call(d,x)&&!i.hasOwnProperty(x)&&(w[x]=d[x]);if(f&&f.defaultProps)for(x in d=f.defaultProps,d)w[x]===void 0&&(w[x]=d[x]);return{$$typeof:t,type:f,key:m,ref:S,props:w,_owner:s.current}}return J.Fragment=r,J.jsx=l,J.jsxs=l,J}var Se;function Ct(){return Se||(Se=1,de.exports=Et()),de.exports}var n=Ct(),ee={},ke;function It(){if(ke)return ee;ke=1;var e=tt();return ee.createRoot=e.createRoot,ee.hydrateRoot=e.hydrateRoot,ee}var Tt=It();const At=nt(Tt);function Wt(){const e=se(),t=g.useRef(null);return g.useEffect(()=>{const r=t.current,o=r.getContext("2d"),s=r.width=180,i=r.height=180,l=Math.floor(s/10),f=Array(l).fill(0);let d;function b(){o.fillStyle="rgba(34,34,68,0.15)",o.fillRect(0,0,s,i),o.fillStyle="#00ff99",o.font="14px monospace",f.forEach((x,w)=>{const m=String.fromCharCode(12448+Math.random()*96);o.fillText(m,w*10,x),x>i+Math.random()*100?f[w]=0:f[w]=x+10}),d=requestAnimationFrame(b)}return b(),()=>cancelAnimationFrame(d)},[]),n.jsxs("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #23234a 0%, #181828 100%)",position:"relative",overflow:"hidden"},children:[n.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"radial-gradient(circle at 20% 80%, rgba(28, 198, 255, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(252, 92, 125, 0.1) 0%, transparent 50%)",pointerEvents:"none"}}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:32,position:"relative",zIndex:1},children:[n.jsxs("div",{style:{position:"relative",width:180,height:180,marginBottom:24,filter:"drop-shadow(0 8px 32px rgba(28, 198, 255, 0.3))"},children:[n.jsx("canvas",{ref:t,width:180,height:180,style:{borderRadius:"50%",background:"linear-gradient(135deg, #6a82fb 0%, #fc5c7d 100%)",boxShadow:"0 4px 32px #0008",border:"2px solid rgba(62, 242, 255, 0.3)"}}),n.jsx("div",{style:{position:"absolute",top:0,left:0,width:180,height:180,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:n.jsxs("svg",{width:"80",height:"80",viewBox:"0 0 80 80",children:[n.jsx("circle",{cx:"40",cy:"40",r:"36",fill:"#fff",opacity:"0.15"}),n.jsx("path",{d:"M40 22a18 18 0 0 1 18 18H22A18 18 0 0 1 40 22z",fill:"#fff"})]})})]}),n.jsx("h1",{style:{color:"#3ef2ff",fontWeight:900,fontSize:"48px",margin:0,letterSpacing:2,textShadow:"0 4px 16px rgba(62, 242, 255, 0.5)",animation:"glow 2s ease-in-out infinite alternate"},children:"Chat-changing"}),n.jsx("div",{style:{color:"#a0f0ff",fontWeight:500,fontSize:"20px",marginBottom:32,textAlign:"center",maxWidth:"400px",lineHeight:1.4},children:"Messagerie moderne et sécurisée"}),n.jsxs("div",{style:{display:"flex",gap:0,marginBottom:16,filter:"drop-shadow(0 4px 16px rgba(0, 0, 0, 0.3))"},children:[n.jsx("button",{onClick:()=>e("/login"),style:{flex:1,padding:"16px 48px",fontSize:"22px",fontWeight:700,border:"none",borderRadius:"32px 0 0 32px",background:"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)",color:"#fff",boxShadow:"0 2px 16px #1cc6ff44",cursor:"pointer",outline:"none",transition:"all 0.3s ease",position:"relative",overflow:"hidden"},onMouseEnter:r=>{r.target.style.transform="translateY(-2px)",r.target.style.boxShadow="0 4px 24px #1cc6ff66"},onMouseLeave:r=>{r.target.style.transform="translateY(0)",r.target.style.boxShadow="0 2px 16px #1cc6ff44"},children:"Connexion"}),n.jsx("button",{onClick:()=>e("/register"),style:{flex:1,padding:"16px 48px",fontSize:"22px",fontWeight:700,border:"none",borderRadius:"0 32px 32px 0",background:"linear-gradient(90deg, #fc5c7d 0%, #6a82fb 100%)",color:"#fff",boxShadow:"0 2px 16px #fc5c7d44",cursor:"pointer",outline:"none",transition:"all 0.3s ease",position:"relative",overflow:"hidden"},onMouseEnter:r=>{r.target.style.transform="translateY(-2px)",r.target.style.boxShadow="0 4px 24px #fc5c7d66"},onMouseLeave:r=>{r.target.style.transform="translateY(0)",r.target.style.boxShadow="0 2px 16px #fc5c7d44"},children:"Inscription"})]}),n.jsx("div",{style:{color:"#a0f0ff",fontSize:"14px",opacity:.7,textAlign:"center",maxWidth:"300px"},children:"Connectez-vous pour accéder à votre messagerie privée"})]})]})}const Re={success:"#4caf50",error:"#f44336",info:"#2196f3",warning:"#ff9800"};function Ut({open:e,message:t,severity:r="info",onClose:o}){const[s,i]=g.useState(!0);g.useEffect(()=>(i(!0),()=>{i(!1)}),[]),g.useEffect(()=>{if(s&&e){const f=setTimeout(()=>{s&&o&&o()},3200);return()=>{clearTimeout(f)}}},[e,o,s]);const l=g.useCallback(()=>{s&&o&&o()},[o,s]);return s?n.jsxs("div",{style:{position:"fixed",right:32,bottom:e?32:-80,minWidth:240,maxWidth:360,background:Re[r]||Re.info,color:"#fff",borderRadius:12,boxShadow:"0 4px 24px #0003",padding:"16px 28px",fontSize:17,fontWeight:500,opacity:e?1:0,pointerEvents:e?"auto":"none",zIndex:9999,transition:"all 0.4s cubic-bezier(.4,2,.6,1)",display:"flex",alignItems:"center",gap:12,transform:e?"translateY(0)":"translateY(20px)"},role:"alert","aria-live":"polite",children:[n.jsxs("span",{style:{fontSize:22},children:[r==="success"&&"✔️",r==="error"&&"❌",r==="info"&&"ℹ️",r==="warning"&&"⚠️"]}),n.jsx("span",{children:t}),n.jsx("button",{onClick:l,style:{marginLeft:"auto",background:"none",border:"none",color:"#fff",fontSize:22,cursor:"pointer",transition:"opacity 0.2s"},onMouseEnter:f=>{f.target.style.opacity="0.8"},onMouseLeave:f=>{f.target.style.opacity="1"},"aria-label":"Fermer la notification",children:"×"})]}):null}const Le=g.createContext();function Dt({children:e}){const[t,r]=g.useState({open:!1,message:"",severity:"info"}),[o,s]=g.useState(!0);g.useEffect(()=>(s(!0),()=>{s(!1)}),[]);const i=g.useCallback(({message:f,severity:d="info"})=>{o&&r({open:!0,message:f,severity:d})},[o]),l=g.useCallback(()=>{o&&r(f=>({...f,open:!1}))},[o]);return o?n.jsxs(Le.Provider,{value:{showToast:i},children:[e,n.jsx(Ut,{open:t.open,message:t.message,severity:t.severity,onClose:l})]}):n.jsx(n.Fragment,{children:e})}function X(){const e=g.useContext(Le);if(!e)throw new Error("useToast must be used within a ToastProvider");return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ne="firebasestorage.googleapis.com",Me="storageBucket",zt=120*1e3,Lt=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z extends ct{constructor(t,r,o=0){super(ce(t),`Firebase Storage: ${r} (${ce(t)})`),this.status_=o,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,z.prototype)}get status(){return this.status_}set status(t){this.status_=t}_codeEquals(t){return ce(t)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var D;(function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(D||(D={}));function ce(e){return"storage/"+e}function fe(){const e="An unknown error occurred, please check the error payload for server response.";return new z(D.UNKNOWN,e)}function Nt(e){return new z(D.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")}function Mt(e){return new z(D.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Ot(){const e="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new z(D.UNAUTHENTICATED,e)}function Pt(){return new z(D.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Bt(e){return new z(D.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function Ft(){return new z(D.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function qt(){return new z(D.CANCELED,"User canceled the upload/download.")}function Vt(e){return new z(D.INVALID_URL,"Invalid URL '"+e+"'.")}function Ht(e){return new z(D.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function $t(){return new z(D.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Me+"' property when initializing the app?")}function Yt(){return new z(D.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Gt(){return new z(D.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Xt(e){return new z(D.UNSUPPORTED_ENVIRONMENT,`${e} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function pe(e){return new z(D.INVALID_ARGUMENT,e)}function Oe(){return new z(D.APP_DELETED,"The Firebase app was deleted.")}function Kt(e){return new z(D.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Q(e,t){return new z(D.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function Z(e){throw new z(D.INTERNAL_ERROR,"Internal error: "+e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(t,r){this.bucket=t,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(t,r){let o;try{o=O.makeFromUrl(t,r)}catch{return new O(t,"")}if(o.path==="")return o;throw Ht(t)}static makeFromUrl(t,r){let o=null;const s="([A-Za-z0-9.\\-_]+)";function i(E){E.path.charAt(E.path.length-1)==="/"&&(E.path_=E.path_.slice(0,-1))}const l="(/(.*))?$",f=new RegExp("^gs://"+s+l,"i"),d={bucket:1,path:3};function b(E){E.path_=decodeURIComponent(E.path)}const x="v[A-Za-z0-9_]+",w=r.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",S=new RegExp(`^https?://${w}/${x}/b/${s}/o${m}`,"i"),u={bucket:1,path:3},y=r===Ne?"(?:storage.googleapis.com|storage.cloud.google.com)":r,h="([^?#]*)",C=new RegExp(`^https?://${y}/${s}/${h}`,"i"),_=[{regex:f,indices:d,postModify:i},{regex:S,indices:u,postModify:b},{regex:C,indices:{bucket:1,path:2},postModify:b}];for(let E=0;E<_.length;E++){const p=_[E],k=p.regex.exec(t);if(k){const R=k[p.indices.bucket];let a=k[p.indices.path];a||(a=""),o=new O(R,a),p.postModify(o);break}}if(o==null)throw Vt(t);return o}}class Jt{constructor(t){this.promise_=Promise.reject(t)}getPromise(){return this.promise_}cancel(t=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zt(e,t,r){let o=1,s=null,i=null,l=!1,f=0;function d(){return f===2}let b=!1;function x(...h){b||(b=!0,t.apply(null,h))}function w(h){s=setTimeout(()=>{s=null,e(S,d())},h)}function m(){i&&clearTimeout(i)}function S(h,...C){if(b){m();return}if(h){m(),x.call(null,h,...C);return}if(d()||l){m(),x.call(null,h,...C);return}o<64&&(o*=2);let _;f===1?(f=2,_=0):_=(o+Math.random())*1e3,w(_)}let u=!1;function y(h){u||(u=!0,m(),!b&&(s!==null?(h||(f=2),clearTimeout(s),w(0)):h||(f=1)))}return w(0),i=setTimeout(()=>{l=!0,y(!0)},r),y}function Qt(e){e(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(e){return e!==void 0}function tn(e){return typeof e=="object"&&!Array.isArray(e)}function ge(e){return typeof e=="string"||e instanceof String}function je(e){return he()&&e instanceof Blob}function he(){return typeof Blob<"u"}function _e(e,t,r,o){if(o<t)throw pe(`Invalid value for '${e}'. Expected ${t} or greater.`);if(o>r)throw pe(`Invalid value for '${e}'. Expected ${r} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xe(e,t,r){let o=t;return r==null&&(o=`https://${t}`),`${r}://${o}/v0${e}`}function Pe(e){const t=encodeURIComponent;let r="?";for(const o in e)if(e.hasOwnProperty(o)){const s=t(o)+"="+t(e[o]);r=r+s+"&"}return r=r.slice(0,-1),r}var Y;(function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"})(Y||(Y={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nn(e,t){const r=e>=500&&e<600,s=[408,429].indexOf(e)!==-1,i=t.indexOf(e)!==-1;return r||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(t,r,o,s,i,l,f,d,b,x,w,m=!0,S=!1){this.url_=t,this.method_=r,this.headers_=o,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=l,this.callback_=f,this.errorCallback_=d,this.timeout_=b,this.progressCallback_=x,this.connectionFactory_=w,this.retry=m,this.isUsingEmulator=S,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((u,y)=>{this.resolve_=u,this.reject_=y,this.start_()})}start_(){const t=(o,s)=>{if(s){o(!1,new te(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const l=f=>{const d=f.loaded,b=f.lengthComputable?f.total:-1;this.progressCallback_!==null&&this.progressCallback_(d,b)};this.progressCallback_!==null&&i.addUploadProgressListener(l),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(l),this.pendingConnection_=null;const f=i.getErrorCode()===Y.NO_ERROR,d=i.getStatus();if(!f||nn(d,this.additionalRetryCodes_)&&this.retry){const x=i.getErrorCode()===Y.ABORT;o(!1,new te(!1,null,x));return}const b=this.successCodes_.indexOf(d)!==-1;o(!0,new te(b,i))})},r=(o,s)=>{const i=this.resolve_,l=this.reject_,f=s.connection;if(s.wasSuccessCode)try{const d=this.callback_(f,f.getResponse());en(d)?i(d):i()}catch(d){l(d)}else if(f!==null){const d=fe();d.serverResponse=f.getErrorText(),this.errorCallback_?l(this.errorCallback_(f,d)):l(d)}else if(s.canceled){const d=this.appDelete_?Oe():qt();l(d)}else{const d=Ft();l(d)}};this.canceled_?r(!1,new te(!1,null,!0)):this.backoffId_=Zt(t,r,this.timeout_)}getPromise(){return this.promise_}cancel(t){this.canceled_=!0,this.appDelete_=t||!1,this.backoffId_!==null&&Qt(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class te{constructor(t,r,o){this.wasSuccessCode=t,this.connection=r,this.canceled=!!o}}function on(e,t){t!==null&&t.length>0&&(e.Authorization="Firebase "+t)}function sn(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}function an(e,t){t&&(e["X-Firebase-GMPID"]=t)}function ln(e,t){t!==null&&(e["X-Firebase-AppCheck"]=t)}function dn(e,t,r,o,s,i,l=!0,f=!1){const d=Pe(e.urlParams),b=e.url+d,x=Object.assign({},e.headers);return an(x,t),on(x,r),sn(x,i),ln(x,o),new rn(b,e.method,x,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,l,f)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cn(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function un(...e){const t=cn();if(t!==void 0){const r=new t;for(let o=0;o<e.length;o++)r.append(e[o]);return r.getBlob()}else{if(he())return new Blob(e);throw new z(D.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function pn(e,t,r){return e.webkitSlice?e.webkitSlice(t,r):e.mozSlice?e.mozSlice(t,r):e.slice?e.slice(t,r):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fn(e){if(typeof atob>"u")throw Xt("base-64");return atob(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class ue{constructor(t,r){this.data=t,this.contentType=r||null}}function gn(e,t){switch(e){case F.RAW:return new ue(Be(t));case F.BASE64:case F.BASE64URL:return new ue(Fe(e,t));case F.DATA_URL:return new ue(xn(t),bn(t))}throw fe()}function Be(e){const t=[];for(let r=0;r<e.length;r++){let o=e.charCodeAt(r);if(o<=127)t.push(o);else if(o<=2047)t.push(192|o>>6,128|o&63);else if((o&64512)===55296)if(!(r<e.length-1&&(e.charCodeAt(r+1)&64512)===56320))t.push(239,191,189);else{const i=o,l=e.charCodeAt(++r);o=65536|(i&1023)<<10|l&1023,t.push(240|o>>18,128|o>>12&63,128|o>>6&63,128|o&63)}else(o&64512)===56320?t.push(239,191,189):t.push(224|o>>12,128|o>>6&63,128|o&63)}return new Uint8Array(t)}function hn(e){let t;try{t=decodeURIComponent(e)}catch{throw Q(F.DATA_URL,"Malformed data URL.")}return Be(t)}function Fe(e,t){switch(e){case F.BASE64:{const s=t.indexOf("-")!==-1,i=t.indexOf("_")!==-1;if(s||i)throw Q(e,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case F.BASE64URL:{const s=t.indexOf("+")!==-1,i=t.indexOf("/")!==-1;if(s||i)throw Q(e,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=fn(t)}catch(s){throw s.message.includes("polyfill")?s:Q(e,"Invalid character found")}const o=new Uint8Array(r.length);for(let s=0;s<r.length;s++)o[s]=r.charCodeAt(s);return o}class qe{constructor(t){this.base64=!1,this.contentType=null;const r=t.match(/^data:([^,]+)?,/);if(r===null)throw Q(F.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const o=r[1]||null;o!=null&&(this.base64=mn(o,";base64"),this.contentType=this.base64?o.substring(0,o.length-7):o),this.rest=t.substring(t.indexOf(",")+1)}}function xn(e){const t=new qe(e);return t.base64?Fe(F.BASE64,t.rest):hn(t.rest)}function bn(e){return new qe(e).contentType}function mn(e,t){return e.length>=t.length?e.substring(e.length-t.length)===t:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(t,r){let o=0,s="";je(t)?(this.data_=t,o=t.size,s=t.type):t instanceof ArrayBuffer?(r?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),o=this.data_.length):t instanceof Uint8Array&&(r?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),o=t.length),this.size_=o,this.type_=s}size(){return this.size_}type(){return this.type_}slice(t,r){if(je(this.data_)){const o=this.data_,s=pn(o,t,r);return s===null?null:new $(s)}else{const o=new Uint8Array(this.data_.buffer,t,r-t);return new $(o,!0)}}static getBlob(...t){if(he()){const r=t.map(o=>o instanceof $?o.data_:o);return new $(un.apply(null,r))}else{const r=t.map(l=>ge(l)?gn(F.RAW,l).data:l.data_);let o=0;r.forEach(l=>{o+=l.byteLength});const s=new Uint8Array(o);let i=0;return r.forEach(l=>{for(let f=0;f<l.length;f++)s[i++]=l[f]}),new $(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ve(e){let t;try{t=JSON.parse(e)}catch{return null}return tn(t)?t:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yn(e){if(e.length===0)return null;const t=e.lastIndexOf("/");return t===-1?"":e.slice(0,t)}function wn(e,t){const r=t.split("/").filter(o=>o.length>0).join("/");return e.length===0?r:e+"/"+r}function He(e){const t=e.lastIndexOf("/",e.length-2);return t===-1?e:e.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vn(e,t){return t}class N{constructor(t,r,o,s){this.server=t,this.local=r||t,this.writable=!!o,this.xform=s||vn}}let ne=null;function Sn(e){return!ge(e)||e.length<2?e:He(e)}function $e(){if(ne)return ne;const e=[];e.push(new N("bucket")),e.push(new N("generation")),e.push(new N("metageneration")),e.push(new N("name","fullPath",!0));function t(i,l){return Sn(l)}const r=new N("name");r.xform=t,e.push(r);function o(i,l){return l!==void 0?Number(l):l}const s=new N("size");return s.xform=o,e.push(s),e.push(new N("timeCreated")),e.push(new N("updated")),e.push(new N("md5Hash",null,!0)),e.push(new N("cacheControl",null,!0)),e.push(new N("contentDisposition",null,!0)),e.push(new N("contentEncoding",null,!0)),e.push(new N("contentLanguage",null,!0)),e.push(new N("contentType",null,!0)),e.push(new N("metadata","customMetadata",!0)),ne=e,ne}function kn(e,t){function r(){const o=e.bucket,s=e.fullPath,i=new O(o,s);return t._makeStorageReference(i)}Object.defineProperty(e,"ref",{get:r})}function Rn(e,t,r){const o={};o.type="file";const s=r.length;for(let i=0;i<s;i++){const l=r[i];o[l.local]=l.xform(o,t[l.server])}return kn(o,e),o}function Ye(e,t,r){const o=Ve(t);return o===null?null:Rn(e,o,r)}function jn(e,t,r,o){const s=Ve(t);if(s===null||!ge(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const l=encodeURIComponent;return i.split(",").map(b=>{const x=e.bucket,w=e.fullPath,m="/b/"+l(x)+"/o/"+l(w),S=xe(m,r,o),u=Pe({alt:"media",token:b});return S+u})[0]}function _n(e,t){const r={},o=t.length;for(let s=0;s<o;s++){const i=t[s];i.writable&&(r[i.server]=e[i.local])}return JSON.stringify(r)}class Ge{constructor(t,r,o,s){this.url=t,this.method=r,this.handler=o,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xe(e){if(!e)throw fe()}function En(e,t){function r(o,s){const i=Ye(e,s,t);return Xe(i!==null),i}return r}function Cn(e,t){function r(o,s){const i=Ye(e,s,t);return Xe(i!==null),jn(i,s,e.host,e._protocol)}return r}function Ke(e){function t(r,o){let s;return r.getStatus()===401?r.getErrorText().includes("Firebase App Check token is invalid")?s=Pt():s=Ot():r.getStatus()===402?s=Mt(e.bucket):r.getStatus()===403?s=Bt(e.path):s=o,s.status=r.getStatus(),s.serverResponse=o.serverResponse,s}return t}function In(e){const t=Ke(e);function r(o,s){let i=t(o,s);return o.getStatus()===404&&(i=Nt(e.path)),i.serverResponse=s.serverResponse,i}return r}function Tn(e,t,r){const o=t.fullServerUrl(),s=xe(o,e.host,e._protocol),i="GET",l=e.maxOperationRetryTime,f=new Ge(s,i,Cn(e,r),l);return f.errorHandler=In(t),f}function An(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function Wn(e,t,r){const o=Object.assign({},r);return o.fullPath=e.path,o.size=t.size(),o.contentType||(o.contentType=An(null,t)),o}function Un(e,t,r,o,s){const i=t.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"};function f(){let _="";for(let E=0;E<2;E++)_=_+Math.random().toString().slice(2);return _}const d=f();l["Content-Type"]="multipart/related; boundary="+d;const b=Wn(t,o,s),x=_n(b,r),w="--"+d+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+x+`\r
--`+d+`\r
Content-Type: `+b.contentType+`\r
\r
`,m=`\r
--`+d+"--",S=$.getBlob(w,o,m);if(S===null)throw Yt();const u={name:b.fullPath},y=xe(i,e.host,e._protocol),h="POST",C=e.maxUploadRetryTime,c=new Ge(y,h,En(e,r),C);return c.urlParams=u,c.headers=l,c.body=S.uploadData(),c.errorHandler=Ke(t),c}class Dn{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Y.NO_ERROR,this.sendPromise_=new Promise(t=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Y.ABORT,t()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Y.NETWORK_ERROR,t()}),this.xhr_.addEventListener("load",()=>{t()})})}send(t,r,o,s,i){if(this.sent_)throw Z("cannot .send() more than once");if(De(t)&&o&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(r,t,!0),i!==void 0)for(const l in i)i.hasOwnProperty(l)&&this.xhr_.setRequestHeader(l,i[l].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Z("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Z("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Z("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Z("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(t){return this.xhr_.getResponseHeader(t)}addUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",t)}removeUploadProgressListener(t){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",t)}}class zn extends Dn{initXhr(){this.xhr_.responseType="text"}}function Je(){return new zn}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(t,r){this._service=t,r instanceof O?this._location=r:this._location=O.makeFromUrl(r,t.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(t,r){return new G(t,r)}get root(){const t=new O(this._location.bucket,"");return this._newRef(this._service,t)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return He(this._location.path)}get storage(){return this._service}get parent(){const t=yn(this._location.path);if(t===null)return null;const r=new O(this._location.bucket,t);return new G(this._service,r)}_throwIfRoot(t){if(this._location.path==="")throw Kt(t)}}function Ln(e,t,r){e._throwIfRoot("uploadBytes");const o=Un(e.storage,e._location,$e(),new $(t,!0),r);return e.storage.makeRequestWithTokens(o,Je).then(s=>({metadata:s,ref:e}))}function Nn(e){e._throwIfRoot("getDownloadURL");const t=Tn(e.storage,e._location,$e());return e.storage.makeRequestWithTokens(t,Je).then(r=>{if(r===null)throw Gt();return r})}function Mn(e,t){const r=wn(e._location.path,t),o=new O(e._location.bucket,r);return new G(e.storage,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function On(e){return/^[A-Za-z]+:\/\//.test(e)}function Pn(e,t){return new G(e,t)}function Ze(e,t){if(e instanceof be){const r=e;if(r._bucket==null)throw $t();const o=new G(r,r._bucket);return t!=null?Ze(o,t):o}else return t!==void 0?Mn(e,t):e}function Bn(e,t){if(t&&On(t)){if(e instanceof be)return Pn(e,t);throw pe("To use ref(service, url), the first argument must be a Storage instance.")}else return Ze(e,t)}function Ee(e,t){const r=t?.[Me];return r==null?null:O.makeFromBucketSpec(r,e)}function Fn(e,t,r,o={}){e.host=`${t}:${r}`;const s=De(t);s&&(ft(`https://${e.host}/b`),gt("Storage",!0)),e._isUsingEmulator=!0,e._protocol=s?"https":"http";const{mockUserToken:i}=o;i&&(e._overrideAuthToken=typeof i=="string"?i:ht(i,e.app.options.projectId))}class be{constructor(t,r,o,s,i,l=!1){this.app=t,this._authProvider=r,this._appCheckProvider=o,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=l,this._bucket=null,this._host=Ne,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=zt,this._maxUploadRetryTime=Lt,this._requests=new Set,s!=null?this._bucket=O.makeFromBucketSpec(s,this._host):this._bucket=Ee(this._host,this.app.options)}get host(){return this._host}set host(t){this._host=t,this._url!=null?this._bucket=O.makeFromBucketSpec(this._url,t):this._bucket=Ee(t,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(t){_e("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(t){_e("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const t=this._authProvider.getImmediate({optional:!0});if(t){const r=await t.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){if(dt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=this._appCheckProvider.getImmediate({optional:!0});return t?(await t.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(t=>t.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(t){return new G(this,t)}_makeRequest(t,r,o,s,i=!0){if(this._deleted)return new Jt(Oe());{const l=dn(t,this._appId,o,s,r,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(t,r){const[o,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(t,r,o,s).getPromise()}}const Ce="@firebase/storage",Ie="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qe="storage";function qn(e,t,r){return e=ie(e),Ln(e,t,r)}function Vn(e){return e=ie(e),Nn(e)}function Hn(e,t){return e=ie(e),Bn(e,t)}function $n(e=Ue(),t){e=ie(e);const o=ut(e,Qe).getImmediate({identifier:t}),s=pt("storage");return s&&Yn(o,...s),o}function Yn(e,t,r,o={}){Fn(e,t,r,o)}function Gn(e,{instanceIdentifier:t}){const r=e.getProvider("app").getImmediate(),o=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new be(r,o,s,t,lt)}function Xn(){it(new at(Qe,Gn,"PUBLIC").setMultipleInstances(!0)),ye(Ce,Ie,""),ye(Ce,Ie,"esm2020")}Xn();const Kn={apiKey:"AIzaSyDW3ze_OVVjr5I79e0zqDbvnOUi2YRnPFA",authDomain:"chat-changing.firebaseapp.com",projectId:"chat-changing",storageBucket:"chat-changing.appspot.com",messagingSenderId:"38586122759",appId:"1:38586122759:web:07e8309564df8ce71aa0a2",measurementId:"G-NTW1DN98K3"};let ae;try{ae=bt().length?Ue():xt(Kn)}catch{throw new Error("Impossible d'initialiser Firebase")}const j=mt(ae),W=yt(ae),Jn=$n(ae);function Te({mode:e="login"}){const[t,r]=g.useState(e),[o,s]=g.useState(""),[i,l]=g.useState(""),[f,d]=g.useState(!1),[b,x]=g.useState(!0),w=se(),{showToast:m}=X(),[S,u]=g.useState(!1),[y,h]=g.useState(!1),[C,c]=g.useState(0);g.useEffect(()=>(x(!0),()=>{x(!1)}),[]);const _=async()=>{if(b){h(!0);try{const k=new wt,a=(await vt(j,k)).user;await re(H(W,"users",a.uid),{displayName:a.displayName||a.email.split("@")[0],email:a.email,avatar:a.photoURL||"",bio:"",phone:"",location:"",website:"",createdAt:new Date().toISOString(),online:!0},{merge:!0}),b&&(w("/chat"),m({message:"Connexion Google réussie !",severity:"success"}))}catch(k){if(b){h(!1);let R="Erreur lors de la connexion Google";k.code==="auth/popup-closed-by-user"?R="Connexion annulée":k.code==="auth/popup-blocked"&&(R="Popup bloqué. Autorisez les popups pour ce site."),m({message:R,severity:"error"})}}finally{b&&h(!1)}}},E=async k=>{if(k.preventDefault(),!!b){if(!o.trim()){m({message:"Veuillez entrer votre email",severity:"error"});return}if(!i.trim()){m({message:"Veuillez entrer votre mot de passe",severity:"error"});return}u(!0);try{let R=null;t==="login"?R=await St(j,o.trim(),i):R=await kt(j,o.trim(),i);const a=R?.user||j.currentUser;if(!a){b&&(u(!1),m({message:"Erreur d'authentification, réessaie.",severity:"error"}));return}t==="register"?await re(H(W,"users",a.uid),{displayName:a.displayName||o.split("@")[0],email:a.email,avatar:"",bio:"",phone:"",location:"",website:"",createdAt:new Date().toISOString(),online:!0}):await re(H(W,"users",a.uid),{online:!0,lastSeen:new Date().toISOString()},{merge:!0}),b&&(w("/chat"),m({message:t==="login"?"Connexion réussie !":"Inscription réussie !",severity:"success"}))}catch(R){if(b){u(!1);let a="Une erreur est survenue";if(R.code)switch(R.code){case"auth/email-already-in-use":a="Cet email est déjà utilisé. Essayez de vous connecter à la place.";break;case"auth/invalid-email":a="L'email n'est pas valide. Vérifiez le format.";break;case"auth/weak-password":a="Le mot de passe doit faire au moins 6 caractères.";break;case"auth/wrong-password":a="Mot de passe incorrect. Vérifiez votre saisie.";break;case"auth/user-not-found":a="Aucun compte trouvé avec cet email. Créez un compte d'abord.";break;case"auth/invalid-credential":a="Email ou mot de passe incorrect. Vérifiez vos identifiants.";break;case"auth/too-many-requests":a="Trop de tentatives. Attendez quelques minutes avant de réessayer.";break;case"auth/network-request-failed":a="Erreur de connexion. Vérifiez votre internet.";break;default:a=`Erreur: ${R.code}`}else R.message&&(a=R.message);m({message:a,severity:"error"})}return}b&&u(!1)}},p=async()=>{if(!o.trim()){m({message:"Entre d'abord ton email pour réinitialiser.",severity:"error"});return}try{await Rt(j,o.trim()),m({message:"Email de réinitialisation envoyé ! Vérifiez votre boîte mail.",severity:"success"})}catch(k){let R="Erreur lors de l'envoi";k.code==="auth/user-not-found"?R="Aucun compte trouvé avec cet email.":k.code==="auth/invalid-email"?R="L'email n'est pas valide.":k.code==="auth/too-many-requests"&&(R="Trop de demandes. Attendez quelques minutes."),m({message:R,severity:"error"})}};return n.jsx("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #23234a 0%, #181828 100%)",color:"#fff",padding:window.innerWidth<=768?"16px":"32px"},children:n.jsxs("div",{style:{maxWidth:window.innerWidth<=768?"100%":420,width:"100%",background:"linear-gradient(135deg, #23234a 0%, #181828 100%)",borderRadius:window.innerWidth<=768?16:24,boxShadow:"0 8px 48px #1cc6ff33",padding:window.innerWidth<=768?20:32,marginTop:window.innerWidth<=768?16:32,border:"1.5px solid #3ef2ff44"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"center",marginBottom:window.innerWidth<=768?24:32,flexDirection:window.innerWidth<=768?"column":"row",gap:window.innerWidth<=768?8:0},children:[n.jsx("button",{onClick:()=>r("login"),style:{flex:1,padding:window.innerWidth<=768?"12px 0":"14px 0",fontSize:window.innerWidth<=768?18:22,fontWeight:700,border:"none",borderRadius:window.innerWidth<=768?"16px":"32px 0 0 32px",background:t==="login"?"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)":"transparent",color:t==="login"?"#fff":"#a0f0ff",boxShadow:t==="login"?"0 2px 16px #1cc6ff44":"none",cursor:"pointer",outline:"none",transition:"background 0.2s"},children:"Connexion"}),n.jsx("button",{onClick:()=>r("register"),style:{flex:1,padding:window.innerWidth<=768?"12px 0":"14px 0",fontSize:window.innerWidth<=768?18:22,fontWeight:700,border:"none",borderRadius:window.innerWidth<=768?"16px":"0 32px 32px 0",background:t==="register"?"linear-gradient(90deg, #fc5c7d 0%, #6a82fb 100%)":"transparent",color:t==="register"?"#fff":"#a0f0ff",boxShadow:t==="register"?"0 2px 16px #fc5c7d44":"none",cursor:"pointer",outline:"none",transition:"background 0.2s"},children:"Inscription"})]}),n.jsxs("button",{onClick:_,disabled:y,style:{width:"100%",padding:window.innerWidth<=768?"12px 0":"14px 0",fontSize:window.innerWidth<=768?16:18,fontWeight:600,border:"none",borderRadius:window.innerWidth<=768?10:12,background:"linear-gradient(90deg, #4285f4 0%, #34a853 100%)",color:"#fff",cursor:y?"not-allowed":"pointer",marginBottom:window.innerWidth<=768?20:24,display:"flex",alignItems:"center",justifyContent:"center",gap:window.innerWidth<=768?8:12,opacity:y?.7:1,transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(66, 133, 244, 0.3)"},onMouseEnter:k=>{y||(k.target.style.transform="translateY(-1px)",k.target.style.boxShadow="0 4px 12px rgba(66, 133, 244, 0.4)")},onMouseLeave:k=>{k.target.style.transform="translateY(0)",k.target.style.boxShadow="0 2px 8px rgba(66, 133, 244, 0.3)"},children:[n.jsx("span",{style:{fontSize:window.innerWidth<=768?18:20},children:"🔍"}),y?"Connexion...":"Continuer avec Google"]}),n.jsxs("div",{style:{textAlign:"center",marginBottom:window.innerWidth<=768?20:24,color:"#a0f0ff",fontSize:window.innerWidth<=768?12:14,position:"relative"},children:[n.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"1px",background:"rgba(160, 240, 255, 0.3)"}}),n.jsx("span",{style:{background:"linear-gradient(135deg, #23234a 0%, #181828 100%)",padding:"0 16px",position:"relative",zIndex:1},children:"ou"})]}),n.jsxs("form",{onSubmit:E,children:[n.jsxs("div",{style:{marginBottom:window.innerWidth<=768?20:24},children:[n.jsx("label",{style:{color:"#a0f0ff",fontWeight:600,fontSize:window.innerWidth<=768?16:18,marginBottom:8,display:"block"},children:"Adresse Email"}),n.jsxs("div",{style:{display:"flex",alignItems:"center",background:"#23234a",borderRadius:window.innerWidth<=768?10:12,padding:window.innerWidth<=768?"10px 14px":"8px 16px",marginBottom:8},children:[n.jsx("span",{style:{color:"#a0f0ff",fontSize:window.innerWidth<=768?18:20,marginRight:8},children:"✉️"}),n.jsx("input",{type:"email",value:o,onChange:k=>s(k.target.value),placeholder:"votre@email.com",style:{flex:1,background:"none",border:"none",color:"#f7f9fb",fontSize:window.innerWidth<=768?16:18,outline:"none",padding:0},required:!0})]})]}),n.jsxs("div",{style:{marginBottom:window.innerWidth<=768?12:16},children:[n.jsx("label",{style:{color:"#a0f0ff",fontWeight:600,fontSize:window.innerWidth<=768?16:18,marginBottom:8,display:"block"},children:"Mot de passe"}),n.jsxs("div",{style:{display:"flex",alignItems:"center",background:"#23234a",borderRadius:window.innerWidth<=768?10:12,padding:window.innerWidth<=768?"10px 14px":"8px 16px"},children:[n.jsx("span",{style:{color:"#a0f0ff",fontSize:window.innerWidth<=768?18:20,marginRight:8},children:"🔒"}),n.jsx("input",{type:f?"text":"password",value:i,onChange:k=>l(k.target.value),placeholder:"••••••••",style:{flex:1,background:"none",border:"none",color:"#f7f9fb",fontSize:window.innerWidth<=768?16:18,outline:"none",padding:0},required:!0}),n.jsx("button",{type:"button",onClick:()=>d(k=>!k),style:{background:"none",border:"none",color:"#a0f0ff",fontSize:window.innerWidth<=768?18:20,cursor:"pointer",marginLeft:8},children:f?"🙈":"👁️"})]}),t==="login"&&n.jsx("div",{style:{textAlign:"right",marginTop:8},children:n.jsx("button",{type:"button",style:{background:"none",border:"none",color:"#3ef2ff",fontWeight:600,cursor:"pointer",fontSize:window.innerWidth<=768?14:16},onClick:p,children:"Mot de passe oublié ?"})})]}),S&&n.jsx("div",{style:{color:"#3ef2ff",fontWeight:700,fontSize:window.innerWidth<=768?16:18,textAlign:"center",marginBottom:window.innerWidth<=768?12:16},children:t==="login"?"Connexion en cours…":"Inscription en cours…"}),n.jsx("button",{type:"submit",disabled:S,style:{width:"100%",padding:window.innerWidth<=768?"12px 0":"14px 0",fontSize:window.innerWidth<=768?18:22,fontWeight:700,border:"none",borderRadius:window.innerWidth<=768?12:16,background:t==="login"?"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)":"linear-gradient(90deg, #fc5c7d 0%, #6a82fb 100%)",color:"#fff",boxShadow:"0 2px 16px #1cc6ff44",cursor:S?"not-allowed":"pointer",outline:"none",marginTop:window.innerWidth<=768?12:16,transition:"all 0.2s",opacity:S?.7:1},children:t==="login"?"Se connecter":"S'inscrire"}),!S&&C>0&&n.jsx("button",{type:"button",onClick:()=>{c(k=>k+1),E(new Event("submit"))},style:{background:"linear-gradient(90deg, #3ef2ff 0%, #2196f3 100%)",color:"#23234a",border:"none",borderRadius:8,padding:window.innerWidth<=768?"8px 20px":"10px 28px",fontSize:window.innerWidth<=768?15:17,fontWeight:600,cursor:"pointer",marginTop:12},children:"Réessayer"})]})]})})}function Zn({onUserSelect:e,onClose:t}){const[r,o]=g.useState(""),[s,i]=g.useState([]),[l,f]=g.useState(!1),[d,b]=g.useState(!0),{showToast:x}=X();g.useEffect(()=>(b(!0),()=>{b(!1)}),[]);const w=g.useCallback(async u=>{if(!u.trim()||u.length<3||!d){d&&i([]);return}f(!0);try{const y=M(W,"users"),h=B(y,P("email",">=",u),P("email","<=",u+""),we(10)),C=await V(h),c=[];C.forEach(a=>{const v=a.data();v.email!==j.currentUser?.email&&c.push({id:a.id,...v})});const _=B(y,P("displayName",">=",u),P("displayName","<=",u+""),we(10)),E=await V(_),p=[];E.forEach(a=>{const v=a.data();v.email!==j.currentUser?.email&&p.push({id:a.id,...v})});const R=[...c,...p].filter((a,v,I)=>v===I.findIndex(T=>T.id===a.id));d&&i(R)}catch{d&&x({message:"Erreur lors de la recherche",severity:"error"})}finally{d&&f(!1)}},[x,d]),m=g.useCallback(u=>{const y=u.target.value;o(y),y.length>=3?w(y):i([])},[w]),S=g.useCallback(u=>{d&&(e(u),t())},[e,t,d]);return n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(5px)"},children:n.jsxs("div",{style:{background:"linear-gradient(135deg, #23234a 0%, #181828 100%)",padding:"24px",borderRadius:"12px",width:"500px",maxHeight:"80vh",border:"1px solid rgba(62, 242, 255, 0.3)",overflow:"hidden",display:"flex",flexDirection:"column",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[n.jsx("h3",{style:{margin:0,fontSize:"18px",fontWeight:"bold",color:"#3ef2ff"},children:"Rechercher des utilisateurs"}),n.jsx("button",{onClick:t,style:{background:"none",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:"0",width:"30px",height:"30px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},onMouseEnter:u=>{u.target.style.color="#3ef2ff"},onMouseLeave:u=>{u.target.style.color="#fff"},children:"×"})]}),n.jsx("input",{type:"text",placeholder:"Rechercher par email ou nom...",value:r,onChange:m,style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"8px",color:"#fff",fontSize:"14px",marginBottom:"16px",transition:"all 0.3s ease",outline:"none"},onFocus:u=>{u.target.style.border="1px solid rgba(62, 242, 255, 0.6)",u.target.style.boxShadow="0 0 0 3px rgba(62, 242, 255, 0.1)"},onBlur:u=>{u.target.style.border="1px solid rgba(62, 242, 255, 0.3)",u.target.style.boxShadow="none"}}),n.jsx("div",{style:{flex:1,overflowY:"auto",border:"1px solid rgba(62, 242, 255, 0.2)",borderRadius:"8px",background:"rgba(255, 255, 255, 0.05)"},children:l?n.jsxs("div",{style:{textAlign:"center",padding:"20px",color:"#a0f0ff",fontSize:"14px"},children:[n.jsx("div",{style:{fontSize:"24px",marginBottom:"8px"},children:"⏳"}),"Recherche en cours..."]}):s.length===0?n.jsxs("div",{style:{textAlign:"center",padding:"20px",color:"#a0f0ff",fontSize:"14px"},children:[n.jsx("div",{style:{fontSize:"32px",marginBottom:"8px"},children:r.length>=3?"🔍":"💡"}),r.length>=3?"Aucun utilisateur trouvé":"Tapez au moins 3 caractères pour rechercher"]}):s.map(u=>n.jsxs("div",{onClick:()=>S(u),style:{padding:"12px 16px",borderBottom:"1px solid rgba(62, 242, 255, 0.1)",cursor:"pointer",transition:"background 0.2s",display:"flex",alignItems:"center",gap:"12px"},onMouseEnter:y=>{y.target.style.background="rgba(28, 198, 255, 0.1)"},onMouseLeave:y=>{y.target.style.background="transparent"},children:[n.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:u.avatar||"linear-gradient(135deg, #1cc6ff 0%, #009fff 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",fontWeight:"bold",color:"#fff",overflow:"hidden"},children:u.avatar?n.jsx("img",{src:u.avatar,alt:"Avatar",style:{width:"100%",height:"100%",objectFit:"cover"}}):(u.displayName||u.email).charAt(0).toUpperCase()}),n.jsxs("div",{style:{flex:1},children:[n.jsxs("div",{style:{fontWeight:"bold",fontSize:"14px",color:u.online?"#4caf50":"#fff"},children:[u.displayName||u.email,u.online&&n.jsx("span",{style:{marginLeft:"8px",fontSize:"10px",background:"#4caf50",color:"#fff",padding:"2px 6px",borderRadius:"10px"},children:"En ligne"})]}),n.jsx("div",{style:{fontSize:"12px",color:"#a0f0ff",marginTop:"2px"},children:u.email})]}),n.jsx("button",{style:{padding:"6px 12px",background:"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)",border:"none",borderRadius:"6px",color:"#fff",cursor:"pointer",fontSize:"12px",fontWeight:"600",transition:"all 0.2s"},onMouseEnter:y=>{y.target.style.transform="scale(1.05)"},onMouseLeave:y=>{y.target.style.transform="scale(1)"},children:"Ajouter"})]},u.id))})]})})}function Ae({onSelectContact:e,selectedContact:t}){const[r,o]=g.useState([]),[s,i]=g.useState(""),[l,f]=g.useState(!1),[d,b]=g.useState(!1),[x,w]=g.useState(""),[m,S]=g.useState(!1),[u,y]=g.useState(!0),{showToast:h}=X(),C=g.useCallback(async()=>{if(!(!j.currentUser||!u)){S(!0);try{const p=M(W,"users",j.currentUser.uid,"contacts"),k=ze(p,async R=>{const a=[];for(const v of R.docs){const I=v.data(),T=M(W,"users"),A=B(T,P("email","==",I.email)),L=await V(A);if(!L.empty){const U=L.docs[0].data();a.push({id:v.id,email:I.email,displayName:U.displayName||I.email,avatar:U.avatar||null,online:U.online||!1,lastSeen:U.lastSeen||null})}}u&&o(a)},()=>{u&&h({message:"Erreur lors du chargement des contacts",severity:"error"})});return()=>{k&&k()}}catch{u&&h({message:"Erreur lors du chargement des contacts",severity:"error"})}finally{u&&S(!1)}}},[h,u]);g.useEffect(()=>(y(!0),C(),()=>{y(!1)}),[C]);const c=async p=>{if(p.preventDefault(),!(!x.trim()||!u)){S(!0);try{const k=M(W,"users"),R=B(k,P("email","==",x)),a=await V(R);if(a.empty){u&&h({message:"Utilisateur non trouvé",severity:"error"});return}const v=M(W,"users",j.currentUser.uid,"contacts"),I=B(v,P("email","==",x));if(!(await V(I)).empty){u&&h({message:"Ce contact existe déjà dans votre liste",severity:"warning"});return}await q(v,{email:x,addedAt:new Date().toISOString()});const A=M(W,"users",a.docs[0].id,"contacts");if(await q(A,{email:j.currentUser.email,addedAt:new Date().toISOString()}),u){h({message:"Contact ajouté avec succès",severity:"success"}),w(""),f(!1),await C();const L={email:x,displayName:a.docs[0].data().displayName||x,avatar:a.docs[0].data().avatar||null,online:a.docs[0].data().online||!1,lastSeen:a.docs[0].data().lastSeen||null};e(L)}}catch{u&&h({message:"Erreur lors de l'ajout du contact",severity:"error"})}finally{u&&S(!1)}}},_=async p=>{if(u){S(!0);try{const k=M(W,"users",j.currentUser.uid,"contacts"),R=B(k,P("email","==",p.email));if(!(await V(R)).empty){u&&h({message:"Ce contact existe déjà dans votre liste",severity:"warning"});return}await q(k,{email:p.email,addedAt:new Date().toISOString()});const v=M(W,"users",p.uid,"contacts");await q(v,{email:j.currentUser.email,addedAt:new Date().toISOString()}),u&&(h({message:"Contact ajouté avec succès",severity:"success"}),b(!1),await C(),e(p))}catch{u&&h({message:"Erreur lors de l'ajout du contact",severity:"error"})}finally{u&&S(!1)}}},E=r.filter(p=>p.displayName.toLowerCase().includes(s.toLowerCase())||p.email.toLowerCase().includes(s.toLowerCase()));return n.jsxs("div",{style:{width:"320px",background:"rgba(28, 198, 255, 0.05)",borderRight:"1px solid rgba(62, 242, 255, 0.2)",display:"flex",flexDirection:"column",height:"100%",backdropFilter:"blur(10px)",boxShadow:"2px 0 16px rgba(28, 198, 255, 0.1)"},children:[n.jsxs("div",{style:{padding:"20px",borderBottom:"1px solid rgba(62, 242, 255, 0.2)",background:"rgba(28, 198, 255, 0.1)",backdropFilter:"blur(10px)"},children:[n.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"20px",fontWeight:"bold",background:"linear-gradient(90deg, #3ef2ff 0%, #1cc6ff 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Contacts"}),n.jsx("input",{type:"text",placeholder:"Rechercher un contact...",value:s,onChange:p=>i(p.target.value),style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"10px",color:"#fff",fontSize:"14px",transition:"all 0.3s ease",outline:"none"},onFocus:p=>{p.target.style.border="1px solid rgba(62, 242, 255, 0.6)",p.target.style.boxShadow="0 0 0 3px rgba(62, 242, 255, 0.1)"},onBlur:p=>{p.target.style.border="1px solid rgba(62, 242, 255, 0.3)",p.target.style.boxShadow="none"}}),n.jsxs("div",{style:{display:"flex",gap:"10px",marginTop:"12px"},children:[n.jsx("button",{onClick:()=>f(!0),style:{flex:1,padding:"10px 16px",background:"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"13px",fontWeight:"600",transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(28, 198, 255, 0.3)"},onMouseEnter:p=>{p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 4px 12px rgba(28, 198, 255, 0.4)"},onMouseLeave:p=>{p.target.style.transform="translateY(0)",p.target.style.boxShadow="0 2px 8px rgba(28, 198, 255, 0.3)"},children:"+ Contact"}),n.jsx("button",{onClick:()=>b(!0),style:{flex:1,padding:"10px 16px",background:"linear-gradient(90deg, #fc5c7d 0%, #6a82fb 100%)",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"13px",fontWeight:"600",transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(252, 92, 125, 0.3)"},onMouseEnter:p=>{p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 4px 12px rgba(252, 92, 125, 0.4)"},onMouseLeave:p=>{p.target.style.transform="translateY(0)",p.target.style.boxShadow="0 2px 8px rgba(252, 92, 125, 0.3)"},children:"🔍 Rechercher"})]})]}),l&&n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(5px)"},children:n.jsxs("div",{style:{background:"linear-gradient(135deg, #23234a 0%, #181828 100%)",padding:"28px",borderRadius:"16px",width:"420px",border:"1px solid rgba(62, 242, 255, 0.3)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)",animation:"fadeInUp 0.3s ease"},children:[n.jsx("h3",{style:{margin:"0 0 20px 0",fontSize:"20px",fontWeight:"bold",background:"linear-gradient(90deg, #3ef2ff 0%, #1cc6ff 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Ajouter un contact"}),n.jsxs("form",{onSubmit:c,children:[n.jsx("input",{type:"email",placeholder:"Email de l'utilisateur",value:x,onChange:p=>w(p.target.value),style:{width:"100%",padding:"14px 18px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"10px",color:"#fff",fontSize:"14px",marginBottom:"20px",transition:"all 0.3s ease",outline:"none"},onFocus:p=>{p.target.style.border="1px solid rgba(62, 242, 255, 0.6)",p.target.style.boxShadow="0 0 0 3px rgba(62, 242, 255, 0.1)"},onBlur:p=>{p.target.style.border="1px solid rgba(62, 242, 255, 0.3)",p.target.style.boxShadow="none"},required:!0}),n.jsxs("div",{style:{display:"flex",gap:"12px"},children:[n.jsx("button",{type:"submit",disabled:m,style:{flex:1,padding:"14px 20px",background:"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)",border:"none",borderRadius:"10px",color:"#fff",cursor:m?"not-allowed":"pointer",fontSize:"14px",fontWeight:"600",opacity:m?.6:1,transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(28, 198, 255, 0.3)"},onMouseEnter:p=>{m||(p.target.style.transform="translateY(-1px)",p.target.style.boxShadow="0 4px 12px rgba(28, 198, 255, 0.4)")},onMouseLeave:p=>{p.target.style.transform="translateY(0)",p.target.style.boxShadow="0 2px 8px rgba(28, 198, 255, 0.3)"},children:m?"Ajout...":"Ajouter"}),n.jsx("button",{type:"button",onClick:()=>f(!1),style:{flex:1,padding:"14px 20px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"10px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.3s ease"},onMouseEnter:p=>{p.target.style.background="rgba(255, 255, 255, 0.15)"},onMouseLeave:p=>{p.target.style.background="rgba(255, 255, 255, 0.1)"},children:"Annuler"})]})]})]})}),d&&n.jsx(Zn,{onUserSelect:_,onClose:()=>b(!1)}),n.jsx("div",{style:{flex:1,overflowY:"auto",padding:"12px"},children:m?n.jsxs("div",{style:{textAlign:"center",padding:"40px 20px",color:"#a0f0ff",background:"rgba(28, 198, 255, 0.05)",borderRadius:"12px",margin:"10px"},children:[n.jsx("div",{style:{fontSize:"24px",marginBottom:"8px"},children:"⏳"}),"Chargement..."]}):E.length===0?n.jsxs("div",{style:{textAlign:"center",padding:"40px 20px",color:"#a0f0ff",background:"rgba(28, 198, 255, 0.05)",borderRadius:"12px",margin:"10px",border:"1px solid rgba(62, 242, 255, 0.1)"},children:[n.jsx("div",{style:{fontSize:"32px",marginBottom:"12px"},children:s?"🔍":"👥"}),s?"Aucun contact trouvé":"Aucun contact",n.jsx("div",{style:{fontSize:"12px",opacity:.7,marginTop:"8px"},children:s?"Essayez une autre recherche":"Ajoutez votre premier contact"})]}):E.map((p,k)=>n.jsx("div",{onClick:()=>e(p),style:{padding:"14px 16px",margin:"6px 0",background:t?.id===p.id?"rgba(28, 198, 255, 0.2)":"rgba(255, 255, 255, 0.05)",borderRadius:"12px",cursor:"pointer",border:t?.id===p.id?"1px solid rgba(28, 198, 255, 0.5)":"1px solid transparent",transition:"all 0.3s ease",animation:"fadeInUp 0.3s ease",animationDelay:`${k*.05}s`,animationFillMode:"both"},onMouseEnter:R=>{t?.id!==p.id&&(R.target.style.background="rgba(28, 198, 255, 0.1)",R.target.style.transform="translateX(4px)")},onMouseLeave:R=>{t?.id!==p.id&&(R.target.style.background="rgba(255, 255, 255, 0.05)",R.target.style.transform="translateX(0)")},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"14px"},children:[n.jsxs("div",{style:{width:"44px",height:"44px",borderRadius:"50%",background:p.avatar||"linear-gradient(135deg, #1cc6ff 0%, #009fff 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",fontWeight:"bold",color:"#fff",boxShadow:"0 2px 8px rgba(28, 198, 255, 0.3)",border:p.online?"2px solid #4caf50":"2px solid transparent",position:"relative"},children:[p.avatar?n.jsx("img",{src:p.avatar,alt:"Avatar",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"50%"}}):p.displayName.charAt(0).toUpperCase(),p.online&&n.jsx("div",{style:{position:"absolute",bottom:"-2px",right:"-2px",width:"12px",height:"12px",borderRadius:"50%",background:"#4caf50",border:"2px solid #23234a",boxShadow:"0 0 8px rgba(76, 175, 80, 0.5)"}})]}),n.jsxs("div",{style:{flex:1},children:[n.jsx("div",{style:{fontWeight:"bold",fontSize:"15px",color:p.online?"#4caf50":"#fff",marginBottom:"2px"},children:p.displayName}),n.jsx("div",{style:{fontSize:"12px",color:"#a0f0ff",opacity:.8},children:p.email})]}),p.online&&n.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#4caf50",boxShadow:"0 0 8px rgba(76, 175, 80, 0.5)",animation:"pulse 2s infinite"}})]})},p.id))})]})}function Qn({onSendVoice:e,disabled:t=!1}){const[r,o]=g.useState(!1),[s,i]=g.useState(0),[l,f]=g.useState(null),[d,b]=g.useState(null),[x,w]=g.useState(!1),[m,S]=g.useState(0),u=g.useRef(null),y=g.useRef(null),h=g.useRef(null),{showToast:C}=X();g.useEffect(()=>()=>{h.current&&clearInterval(h.current),d&&URL.revokeObjectURL(d)},[d]);const c=async()=>{try{const v=await navigator.mediaDevices.getUserMedia({audio:!0});u.current=new MediaRecorder(v);const I=[];u.current.ondataavailable=T=>{I.push(T.data)},u.current.onstop=()=>{const T=new Blob(I,{type:"audio/webm"});f(T);const A=URL.createObjectURL(T);b(A);const L=new Audio(A);L.addEventListener("loadedmetadata",()=>{S(L.duration)}),v.getTracks().forEach(U=>U.stop())},u.current.start(),o(!0),i(0),h.current=setInterval(()=>{i(T=>T+1)},1e3),C({message:"Enregistrement démarré...",severity:"info"})}catch{C({message:"Erreur d'accès au microphone",severity:"error"})}},_=()=>{u.current&&r&&(u.current.stop(),o(!1),h.current&&clearInterval(h.current),C({message:"Enregistrement terminé",severity:"success"}))},E=()=>{y.current&&(y.current.play(),w(!0))},p=()=>{y.current&&(y.current.pause(),w(!1))},k=()=>{l&&e&&(e(l,m),f(null),b(null),S(0),i(0))},R=()=>{f(null),b(null),S(0),i(0),d&&URL.revokeObjectURL(d)},a=v=>{const I=Math.floor(v/60),T=v%60;return`${I}:${T.toString().padStart(2,"0")}`};return n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",padding:"16px",background:"rgba(28, 198, 255, 0.05)",borderRadius:"12px",border:"1px solid rgba(62, 242, 255, 0.2)",marginTop:"12px"},children:[r&&n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:"rgba(255, 71, 87, 0.1)",borderRadius:"8px",border:"1px solid rgba(255, 71, 87, 0.3)"},children:[n.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"50%",background:"#ff4757",animation:"pulse 1s infinite"}}),n.jsxs("span",{style:{color:"#ff4757",fontWeight:"600"},children:["Enregistrement en cours... ",a(s)]}),n.jsx("button",{onClick:_,style:{padding:"8px 16px",background:"linear-gradient(90deg, #ff4757 0%, #ff3742 100%)",border:"none",borderRadius:"6px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"600"},children:"Arrêter"})]}),l&&!r&&n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:"rgba(28, 198, 255, 0.1)",borderRadius:"8px",border:"1px solid rgba(28, 198, 255, 0.3)"},children:[n.jsx("button",{onClick:x?p:E,style:{padding:"8px",background:"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)",border:"none",borderRadius:"50%",color:"#fff",cursor:"pointer",fontSize:"16px",width:"36px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center"},children:x?"⏸️":"▶️"}),n.jsxs("div",{style:{flex:1},children:[n.jsx("div",{style:{fontSize:"14px",fontWeight:"600",color:"#3ef2ff"},children:"Message vocal"}),n.jsxs("div",{style:{fontSize:"12px",color:"#a0f0ff"},children:["Durée: ",a(Math.floor(m))]})]}),n.jsxs("div",{style:{display:"flex",gap:"8px"},children:[n.jsx("button",{onClick:k,style:{padding:"6px 12px",background:"linear-gradient(90deg, #4caf50 0%, #45a049 100%)",border:"none",borderRadius:"6px",color:"#fff",cursor:"pointer",fontSize:"12px",fontWeight:"600"},children:"Envoyer"}),n.jsx("button",{onClick:R,style:{padding:"6px 12px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:"6px",color:"#fff",cursor:"pointer",fontSize:"12px",fontWeight:"600"},children:"Annuler"})]})]}),!r&&!l&&n.jsx("button",{onClick:c,disabled:t,style:{padding:"12px 20px",background:"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)",border:"none",borderRadius:"8px",color:"#fff",cursor:t?"not-allowed":"pointer",fontSize:"16px",fontWeight:"600",display:"flex",alignItems:"center",gap:"8px",opacity:t?.6:1,transition:"all 0.3s ease"},onMouseEnter:v=>{t||(v.target.style.transform="translateY(-1px)",v.target.style.boxShadow="0 4px 12px rgba(28, 198, 255, 0.4)")},onMouseLeave:v=>{v.target.style.transform="translateY(0)",v.target.style.boxShadow="0 2px 8px rgba(28, 198, 255, 0.3)"},children:"🎤 Enregistrer un message vocal"}),d&&n.jsx("audio",{ref:y,src:d,onEnded:()=>w(!1),onPause:()=>w(!1),onPlay:()=>w(!0),style:{display:"none"}})]})}function er({audioUrl:e,duration:t,sender:r,timestamp:o,isOwnMessage:s}){const[i,l]=g.useState(!1),[f,d]=g.useState(0),[b,x]=g.useState(!1),w=g.useRef(null),m=g.useRef(null);g.useEffect(()=>{const h=w.current;if(!h)return;const C=()=>{x(!0)},c=()=>{d(h.currentTime)},_=()=>{l(!1),d(0)},E=()=>{l(!0)},p=()=>{l(!1)};return h.addEventListener("loadedmetadata",C),h.addEventListener("timeupdate",c),h.addEventListener("ended",_),h.addEventListener("play",E),h.addEventListener("pause",p),()=>{h.removeEventListener("loadedmetadata",C),h.removeEventListener("timeupdate",c),h.removeEventListener("ended",_),h.removeEventListener("play",E),h.removeEventListener("pause",p)}},[]);const S=()=>{w.current&&(i?w.current.pause():w.current.play())},u=h=>{const C=Math.floor(h/60),c=Math.floor(h%60);return`${C}:${c.toString().padStart(2,"0")}`},y=h=>{if(!w.current||!m.current)return;const C=m.current.getBoundingClientRect(),c=h.clientX-C.left,_=C.width,E=c/_;w.current.currentTime=E*w.current.duration};return n.jsxs("div",{style:{padding:"12px 16px",background:s?"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)":"rgba(255, 255, 255, 0.1)",borderRadius:"16px",maxWidth:"280px",border:s?"1px solid rgba(62, 242, 255, 0.3)":"1px solid rgba(255, 255, 255, 0.1)",boxShadow:s?"0 4px 16px rgba(28, 198, 255, 0.3)":"0 2px 8px rgba(0, 0, 0, 0.1)",animation:"fadeInUp 0.3s ease"},children:[n.jsxs("div",{style:{fontSize:"12px",opacity:.7,marginBottom:"8px",fontWeight:"600",color:s?"#fff":"#a0f0ff"},children:[s?"Vous":r," • Message vocal"]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[n.jsx("button",{onClick:S,disabled:!b,style:{padding:"8px",background:s?"rgba(255, 255, 255, 0.2)":"rgba(28, 198, 255, 0.2)",border:"none",borderRadius:"50%",color:s?"#fff":"#3ef2ff",cursor:b?"pointer":"not-allowed",fontSize:"16px",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",opacity:b?1:.6,transition:"all 0.3s ease"},onMouseEnter:h=>{b&&(h.target.style.transform="scale(1.1)")},onMouseLeave:h=>{h.target.style.transform="scale(1)"},children:i?"⏸️":"▶️"}),n.jsxs("div",{style:{flex:1},children:[n.jsx("div",{ref:m,onClick:y,style:{width:"100%",height:"4px",background:s?"rgba(255, 255, 255, 0.3)":"rgba(28, 198, 255, 0.3)",borderRadius:"2px",cursor:"pointer",position:"relative",overflow:"hidden"},children:n.jsx("div",{style:{width:`${b?f/t*100:0}%`,height:"100%",background:s?"rgba(255, 255, 255, 0.8)":"#3ef2ff",borderRadius:"2px",transition:"width 0.1s ease"}})}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"10px",color:s?"rgba(255, 255, 255, 0.8)":"#a0f0ff",marginTop:"4px"},children:[n.jsx("span",{children:u(f)}),n.jsx("span",{children:u(t)})]})]})]}),n.jsx("div",{style:{fontSize:"10px",opacity:.6,marginTop:"8px",textAlign:"right",color:s?"rgba(255, 255, 255, 0.8)":"#a0f0ff"},children:new Date(o).toLocaleTimeString()}),n.jsx("audio",{ref:w,src:e,preload:"metadata",style:{display:"none"}})]})}function tr(){const[e,t]=g.useState(null),[r,o]=g.useState([]),[s,i]=g.useState(""),[l,f]=g.useState(!1),[d,b]=g.useState(null),[x,w]=g.useState(!1),[m,S]=g.useState(!1),u=se(),{showToast:y}=X(),h=g.useCallback(async a=>{if(j.currentUser)try{const v=H(W,"users",j.currentUser.uid);await oe(v,{online:a,lastSeen:new Date().toISOString()})}catch{}},[]);g.useEffect(()=>{const a=j.onAuthStateChanged(v=>{v?h(!0):(u("/login"),y({message:"Veuillez vous connecter pour accéder au chat",severity:"warning"}))});return()=>{a(),h(!1)}},[u,y,h]),g.useEffect(()=>()=>{d&&d()},[d]);const C=g.useCallback(a=>{if(!a)return;const v=M(W,"conversations",a,"messages"),I=B(v,jt("timestamp","asc")),T=ze(I,A=>{const L=[];A.forEach(U=>{L.push({id:U.id,...U.data()})}),o(L)},A=>{console.error("Erreur lors du chargement des messages:",A)});b(()=>T)},[]),c=g.useCallback(async a=>{d&&d(),t(a),o([]),w(!1),S(!1);try{const v=M(W,"conversations"),I=B(v,P("participants","array-contains",j.currentUser.email)),T=await V(I);let A=null;T.forEach(L=>{const U=L.data();U.participants.includes(a.email)&&(A={id:L.id,...U})}),A||(A={id:(await q(v,{participants:[j.currentUser.email,a.email],createdAt:new Date().toISOString(),lastMessageAt:new Date().toISOString()})).id}),C(A.id)}catch{y({message:"Erreur lors de la sélection du contact",severity:"error"})}},[d,y,C]),_=async a=>{try{const v=`voice_messages/${Date.now()}_${j.currentUser.uid}.webm`,I=Hn(Jn,v);return await qn(I,a),await Vn(I)}catch{throw new Error("Erreur lors de l'upload du fichier audio")}},E=async(a,v)=>{if(e){f(!0);try{const I=await _(a),T=M(W,"conversations"),A=B(T,P("participants","array-contains",j.currentUser.email)),L=await V(A);let U=null;L.forEach(le=>{le.data().participants.includes(e.email)&&(U=le.id)}),U||(U=(await q(T,{participants:[j.currentUser.email,e.email],createdAt:new Date().toISOString(),lastMessageAt:new Date().toISOString()})).id);const me=M(W,"conversations",U,"messages");await q(me,{type:"voice",audioUrl:I,duration:v,sender:j.currentUser.email,timestamp:new Date().toISOString()}),await oe(H(W,"conversations",U),{lastMessageAt:new Date().toISOString()}),y({message:"Message vocal envoyé !",severity:"success"})}catch{y({message:"Erreur lors de l'envoi du message vocal",severity:"error"})}finally{f(!1)}}},p=async a=>{if(a.preventDefault(),!(!e||!s.trim()||l)){f(!0);try{const v=M(W,"conversations"),I=B(v,P("participants","array-contains",j.currentUser.email)),T=await V(I);let A=null;T.forEach(U=>{U.data().participants.includes(e.email)&&(A=U.id)}),A||(A=(await q(v,{participants:[j.currentUser.email,e.email],createdAt:new Date().toISOString(),lastMessageAt:new Date().toISOString()})).id);const L=M(W,"conversations",A,"messages");await q(L,{type:"text",text:s.trim(),sender:j.currentUser.email,timestamp:new Date().toISOString()}),await oe(H(W,"conversations",A),{lastMessageAt:new Date().toISOString()}),i("")}catch{y({message:"Erreur lors de l'envoi du message",severity:"error"})}finally{f(!1)}}},k=async()=>{try{d&&d(),await j.signOut(),u("/"),y({message:"Déconnexion réussie",severity:"success"})}catch{y({message:"Erreur lors de la déconnexion",severity:"error"})}},R=(a,v)=>{const I=a.sender===j.currentUser?.email;return a.type==="voice"?n.jsx(er,{audioUrl:a.audioUrl,duration:a.duration,sender:e?.displayName,timestamp:a.timestamp,isOwnMessage:I},a.id):n.jsxs("div",{style:{padding:window.innerWidth<=768?"10px 14px":"12px 16px",background:I?"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)":"rgba(255, 255, 255, 0.1)",borderRadius:window.innerWidth<=768?"18px":"16px",maxWidth:window.innerWidth<=768?"85%":"70%",alignSelf:I?"flex-end":"flex-start",wordWrap:"break-word",boxShadow:I?"0 4px 16px rgba(28, 198, 255, 0.3)":"0 2px 8px rgba(0, 0, 0, 0.1)",border:I?"1px solid rgba(62, 242, 255, 0.3)":"1px solid rgba(255, 255, 255, 0.1)",animation:"fadeInUp 0.3s ease",animationDelay:`${v*.1}s`,animationFillMode:"both",fontSize:window.innerWidth<=768?"14px":"16px",lineHeight:1.4},children:[n.jsx("div",{style:{fontSize:window.innerWidth<=768?"10px":"12px",opacity:.7,marginBottom:"4px",fontWeight:"600"},children:I?"Vous":e?.displayName}),n.jsx("div",{children:a.text}),n.jsx("div",{style:{fontSize:window.innerWidth<=768?"8px":"10px",opacity:.6,marginTop:"4px",textAlign:"right"},children:new Date(a.timestamp).toLocaleTimeString()})]},a.id)};return n.jsxs("div",{style:{minHeight:"100vh",display:"flex",background:"linear-gradient(135deg, #23234a 0%, #181828 100%)",color:"#fff",position:"relative"},children:[n.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"radial-gradient(circle at 10% 20%, rgba(28, 198, 255, 0.05) 0%, transparent 50%), radial-gradient(circle at 90% 80%, rgba(252, 92, 125, 0.05) 0%, transparent 50%)",pointerEvents:"none"}}),n.jsx("div",{style:{position:"relative",zIndex:1,display:window.innerWidth>768?"block":"none"},children:n.jsx(Ae,{onSelectContact:c,selectedContact:e})}),n.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",position:"relative",zIndex:1},children:[n.jsxs("div",{style:{padding:"20px 24px",background:"rgba(28, 198, 255, 0.1)",borderBottom:"1px solid rgba(62, 242, 255, 0.2)",display:"flex",justifyContent:"space-between",alignItems:"center",backdropFilter:"blur(10px)",boxShadow:"0 2px 16px rgba(28, 198, 255, 0.1)"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[window.innerWidth<=768&&n.jsx("button",{onClick:()=>w(!x),style:{background:"none",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:"8px",borderRadius:"8px",transition:"background 0.3s"},onMouseEnter:a=>{a.target.style.background="rgba(255, 255, 255, 0.1)"},onMouseLeave:a=>{a.target.style.background="none"},children:"☰"}),n.jsxs("div",{children:[n.jsx("h1",{style:{margin:0,fontSize:window.innerWidth<=768?"20px":"24px",fontWeight:"bold",background:"linear-gradient(90deg, #3ef2ff 0%, #1cc6ff 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:e?e.displayName:"Chat"}),e&&n.jsxs("div",{style:{fontSize:"14px",color:"#a0f0ff",marginTop:"4px",display:"flex",alignItems:"center",gap:"8px"},children:[n.jsx("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:e.online?"#4caf50":"#ff9800",boxShadow:e.online?"0 0 8px rgba(76, 175, 80, 0.5)":"none"}}),e.online?"En ligne":"Hors ligne"]})]})]}),n.jsxs("div",{style:{display:"flex",gap:"12px"},children:[n.jsx("button",{onClick:()=>u("/profile"),style:{padding:window.innerWidth<=768?"8px 12px":"8px 16px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:window.innerWidth<=768?"12px":"14px",fontWeight:"600",transition:"all 0.3s ease"},onMouseEnter:a=>{a.target.style.background="rgba(255, 255, 255, 0.15)"},onMouseLeave:a=>{a.target.style.background="rgba(255, 255, 255, 0.1)"},children:window.innerWidth<=768?"👤":"Profil"}),n.jsx("button",{onClick:k,style:{padding:window.innerWidth<=768?"8px 12px":"8px 16px",background:"linear-gradient(90deg, #ff4757 0%, #ff3742 100%)",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:window.innerWidth<=768?"12px":"14px",fontWeight:"600",transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(255, 71, 87, 0.3)"},onMouseEnter:a=>{a.target.style.transform="translateY(-1px)",a.target.style.boxShadow="0 4px 12px rgba(255, 71, 87, 0.4)"},onMouseLeave:a=>{a.target.style.transform="translateY(0)",a.target.style.boxShadow="0 2px 8px rgba(255, 71, 87, 0.3)"},children:window.innerWidth<=768?"🚪":"Déconnexion"})]})]}),window.innerWidth<=768&&x&&n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",zIndex:1e3,animation:"fadeInModal 0.3s ease"},children:n.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"linear-gradient(135deg, #23234a 0%, #181828 100%)"},children:[n.jsxs("div",{style:{padding:"20px",display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid rgba(62, 242, 255, 0.2)"},children:[n.jsx("h2",{style:{margin:0,color:"#3ef2ff"},children:"Contacts"}),n.jsx("button",{onClick:()=>w(!1),style:{background:"none",border:"none",color:"#fff",fontSize:"24px",cursor:"pointer",padding:"8px"},children:"✕"})]}),n.jsx("div",{style:{height:"calc(100% - 80px)",overflow:"auto"},children:n.jsx(Ae,{onSelectContact:c,selectedContact:e})})]})}),n.jsx("div",{style:{flex:1,padding:window.innerWidth<=768?"12px":"20px",overflowY:"auto",display:"flex",flexDirection:"column",gap:"12px",background:"rgba(255, 255, 255, 0.02)",height:window.innerWidth<=768?"calc(100vh - 200px)":"auto"},children:e?r.length===0?n.jsxs("div",{style:{textAlign:"center",color:"#a0f0ff",fontSize:window.innerWidth<=768?"14px":"16px",marginTop:"50px",padding:window.innerWidth<=768?"20px":"40px",background:"rgba(28, 198, 255, 0.05)",borderRadius:"16px",border:"1px solid rgba(62, 242, 255, 0.1)"},children:[n.jsx("div",{style:{fontSize:window.innerWidth<=768?"36px":"48px",marginBottom:"16px"},children:"✨"}),"Aucun message pour le moment. Commencez la conversation !"]}):r.map((a,v)=>R(a,v)):n.jsxs("div",{style:{textAlign:"center",color:"#a0f0ff",fontSize:window.innerWidth<=768?"14px":"16px",marginTop:"50px",padding:window.innerWidth<=768?"20px":"40px",background:"rgba(28, 198, 255, 0.05)",borderRadius:"16px",border:"1px solid rgba(62, 242, 255, 0.1)"},children:[n.jsx("div",{style:{fontSize:window.innerWidth<=768?"36px":"48px",marginBottom:"16px"},children:"💬"}),window.innerWidth<=768?"Appuyez sur ☰ pour voir vos contacts":"Sélectionnez un contact pour commencer à discuter"]})}),e&&m&&n.jsx(Qn,{onSendVoice:E,disabled:l}),e&&n.jsxs("form",{onSubmit:p,style:{padding:window.innerWidth<=768?"12px":"20px",background:"rgba(28, 198, 255, 0.05)",borderTop:"1px solid rgba(62, 242, 255, 0.2)",display:"flex",gap:"12px",backdropFilter:"blur(10px)",position:window.innerWidth<=768?"fixed":"relative",bottom:window.innerWidth<=768?0:"auto",left:window.innerWidth<=768?0:"auto",right:window.innerWidth<=768?0:"auto",zIndex:window.innerWidth<=768?100:"auto"},children:[n.jsx("button",{type:"button",onClick:()=>S(!m),style:{padding:window.innerWidth<=768?"12px":"14px",background:m?"linear-gradient(90deg, #ff4757 0%, #ff3742 100%)":"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:window.innerWidth<=768?"20px":"12px",color:"#fff",cursor:"pointer",fontSize:window.innerWidth<=768?"16px":"14px",transition:"all 0.3s ease",minWidth:window.innerWidth<=768?"44px":"auto"},onMouseEnter:a=>{a.target.style.transform="translateY(-1px)"},onMouseLeave:a=>{a.target.style.transform="translateY(0)"},children:"🎤"}),n.jsx("input",{type:"text",value:s,onChange:a=>i(a.target.value),placeholder:"Tapez votre message...",disabled:l,style:{flex:1,padding:window.innerWidth<=768?"12px 16px":"14px 18px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:window.innerWidth<=768?"20px":"12px",color:"#fff",fontSize:window.innerWidth<=768?"16px":"14px",opacity:l?.6:1,transition:"all 0.3s ease",outline:"none"},onFocus:a=>{a.target.style.border="1px solid rgba(62, 242, 255, 0.6)",a.target.style.boxShadow="0 0 0 3px rgba(62, 242, 255, 0.1)"},onBlur:a=>{a.target.style.border="1px solid rgba(62, 242, 255, 0.3)",a.target.style.boxShadow="none"}}),n.jsx("button",{type:"submit",disabled:l||!s.trim(),style:{padding:window.innerWidth<=768?"12px 16px":"14px 24px",background:"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)",border:"none",borderRadius:window.innerWidth<=768?"20px":"12px",color:"#fff",cursor:l||!s.trim()?"not-allowed":"pointer",fontSize:window.innerWidth<=768?"16px":"14px",fontWeight:"bold",opacity:l||!s.trim()?.6:1,transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(28, 198, 255, 0.3)",minWidth:window.innerWidth<=768?"60px":"auto"},onMouseEnter:a=>{!l&&s.trim()&&(a.target.style.transform="translateY(-1px)",a.target.style.boxShadow="0 4px 12px rgba(28, 198, 255, 0.4)")},onMouseLeave:a=>{a.target.style.transform="translateY(0)",a.target.style.boxShadow="0 2px 8px rgba(28, 198, 255, 0.3)"},children:l?"...":window.innerWidth<=768?"📤":"Envoyer"})]})]})]})}function nr(){const[e,t]=g.useState({displayName:"",email:"",avatar:"",bio:"",phone:"",location:"",website:""}),[r,o]=g.useState(!0),[s,i]=g.useState(!1),[l,f]=g.useState(!1),[d,b]=g.useState(""),[x,w]=g.useState(!0),m=se(),{showToast:S}=X(),u=g.useCallback(async()=>{if(x)try{const c=await _t(H(W,"users",j.currentUser.uid));if(c.exists()){const _=c.data();x&&t({displayName:_.displayName||"",email:j.currentUser.email||"",avatar:_.avatar||"",bio:_.bio||"",phone:_.phone||"",location:_.location||"",website:_.website||""})}else await re(H(W,"users",j.currentUser.uid),{displayName:j.currentUser.displayName||"",email:j.currentUser.email,avatar:"",bio:"",phone:"",location:"",website:"",createdAt:new Date().toISOString(),online:!0}),x&&t({displayName:j.currentUser.displayName||"",email:j.currentUser.email||"",avatar:"",bio:"",phone:"",location:"",website:""})}catch{x&&S({message:"Erreur lors du chargement du profil",severity:"error"})}finally{x&&o(!1)}},[S,x]);g.useEffect(()=>{if(w(!0),!j.currentUser){m("/login");return}return u(),()=>{w(!1)}},[m,u]);const y=async c=>{if(c.preventDefault(),!j.currentUser){S({message:"Session expirée, reconnectez-vous.",severity:"error"}),m("/login");return}if(!e.displayName.trim()){S({message:"Le nom ne peut pas être vide",severity:"error"});return}i(!0);try{await oe(H(W,"users",j.currentUser.uid),{displayName:e.displayName.trim(),avatar:e.avatar,bio:e.bio.trim(),phone:e.phone.trim(),location:e.location.trim(),website:e.website.trim(),updatedAt:new Date().toISOString()}),S({message:"Profil mis à jour avec succès !",severity:"success"})}catch{S({message:"Erreur lors de la mise à jour du profil",severity:"error"})}finally{i(!1)}},h=async()=>{try{await j.signOut(),m("/"),S({message:"Déconnexion réussie",severity:"success"})}catch{S({message:"Erreur lors de la déconnexion",severity:"error"})}},C=["https://api.dicebear.com/7.x/avataaars/svg?seed=Felix","https://api.dicebear.com/7.x/avataaars/svg?seed=Aneka","https://api.dicebear.com/7.x/avataaars/svg?seed=Jasper","https://api.dicebear.com/7.x/avataaars/svg?seed=Lily","https://api.dicebear.com/7.x/avataaars/svg?seed=Max","https://api.dicebear.com/7.x/avataaars/svg?seed=Zoe"];return r?n.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #23234a 0%, #181828 100%)",color:"#3ef2ff"},children:n.jsxs("div",{style:{textAlign:"center"},children:[n.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"⏳"}),"Chargement..."]})}):n.jsxs("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #23234a 0%, #181828 100%)",color:"#fff",padding:"20px"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px",padding:"20px",background:"rgba(28, 198, 255, 0.1)",borderRadius:"16px",border:"1px solid rgba(62, 242, 255, 0.2)",backdropFilter:"blur(10px)"},children:[n.jsx("h1",{style:{margin:0,fontSize:"28px",fontWeight:"bold",background:"linear-gradient(90deg, #3ef2ff 0%, #1cc6ff 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Mon Profil"}),n.jsxs("div",{style:{display:"flex",gap:"12px"},children:[n.jsx("button",{onClick:()=>m("/chat"),style:{padding:"10px 20px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.3s ease"},onMouseEnter:c=>{c.target.style.background="rgba(255, 255, 255, 0.15)"},onMouseLeave:c=>{c.target.style.background="rgba(255, 255, 255, 0.1)"},children:"Retour au Chat"}),n.jsx("button",{onClick:h,style:{padding:"10px 20px",background:"linear-gradient(90deg, #ff4757 0%, #ff3742 100%)",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(255, 71, 87, 0.3)"},onMouseEnter:c=>{c.target.style.transform="translateY(-1px)",c.target.style.boxShadow="0 4px 12px rgba(255, 71, 87, 0.4)"},onMouseLeave:c=>{c.target.style.transform="translateY(0)",c.target.style.boxShadow="0 2px 8px rgba(255, 71, 87, 0.3)"},children:"Déconnexion"})]})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 2fr",gap:"32px",maxWidth:"1200px",margin:"0 auto"},children:[n.jsxs("div",{style:{background:"rgba(28, 198, 255, 0.05)",borderRadius:"16px",padding:"24px",border:"1px solid rgba(62, 242, 255, 0.2)",height:"fit-content"},children:[n.jsx("h3",{style:{margin:"0 0 20px 0",fontSize:"20px",fontWeight:"bold",color:"#3ef2ff"},children:"Avatar"}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"16px"},children:[n.jsx("div",{style:{width:"120px",height:"120px",borderRadius:"50%",background:e.avatar||"linear-gradient(135deg, #1cc6ff 0%, #009fff 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"48px",fontWeight:"bold",color:"#fff",boxShadow:"0 4px 16px rgba(28, 198, 255, 0.3)",border:"3px solid rgba(62, 242, 255, 0.3)",overflow:"hidden"},children:e.avatar?n.jsx("img",{src:e.avatar,alt:"Avatar",style:{width:"100%",height:"100%",objectFit:"cover"}}):e.displayName.charAt(0).toUpperCase()}),n.jsx("button",{onClick:()=>f(!0),style:{padding:"10px 20px",background:"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(28, 198, 255, 0.3)"},onMouseEnter:c=>{c.target.style.transform="translateY(-1px)",c.target.style.boxShadow="0 4px 12px rgba(28, 198, 255, 0.4)"},onMouseLeave:c=>{c.target.style.transform="translateY(0)",c.target.style.boxShadow="0 2px 8px rgba(28, 198, 255, 0.3)"},children:"Changer l'avatar"})]})]}),n.jsxs("div",{style:{background:"rgba(28, 198, 255, 0.05)",borderRadius:"16px",padding:"24px",border:"1px solid rgba(62, 242, 255, 0.2)"},children:[n.jsx("h3",{style:{margin:"0 0 24px 0",fontSize:"20px",fontWeight:"bold",color:"#3ef2ff"},children:"Informations Personnelles"}),n.jsxs("form",{onSubmit:y,style:{display:"flex",flexDirection:"column",gap:"16px"},children:[n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#a0f0ff"},children:"Nom d'affichage *"}),n.jsx("input",{type:"text",value:e.displayName,onChange:c=>t({...e,displayName:c.target.value}),placeholder:"Votre nom",style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"8px",color:"#fff",fontSize:"14px",transition:"all 0.3s ease",outline:"none"},onFocus:c=>{c.target.style.border="1px solid rgba(62, 242, 255, 0.6)",c.target.style.boxShadow="0 0 0 3px rgba(62, 242, 255, 0.1)"},onBlur:c=>{c.target.style.border="1px solid rgba(62, 242, 255, 0.3)",c.target.style.boxShadow="none"},maxLength:32,required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#a0f0ff"},children:"Email"}),n.jsx("input",{type:"email",value:e.email,disabled:!0,style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(62, 242, 255, 0.2)",borderRadius:"8px",color:"#a0f0ff",fontSize:"14px",opacity:.7}})]})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#a0f0ff"},children:"Bio"}),n.jsx("textarea",{value:e.bio,onChange:c=>t({...e,bio:c.target.value}),placeholder:"Parlez-nous de vous...",rows:3,style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"8px",color:"#fff",fontSize:"14px",transition:"all 0.3s ease",outline:"none",resize:"vertical",fontFamily:"inherit"},onFocus:c=>{c.target.style.border="1px solid rgba(62, 242, 255, 0.6)",c.target.style.boxShadow="0 0 0 3px rgba(62, 242, 255, 0.1)"},onBlur:c=>{c.target.style.border="1px solid rgba(62, 242, 255, 0.3)",c.target.style.boxShadow="none"},maxLength:200})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#a0f0ff"},children:"Téléphone"}),n.jsx("input",{type:"tel",value:e.phone,onChange:c=>t({...e,phone:c.target.value}),placeholder:"Votre numéro",style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"8px",color:"#fff",fontSize:"14px",transition:"all 0.3s ease",outline:"none"},onFocus:c=>{c.target.style.border="1px solid rgba(62, 242, 255, 0.6)",c.target.style.boxShadow="0 0 0 3px rgba(62, 242, 255, 0.1)"},onBlur:c=>{c.target.style.border="1px solid rgba(62, 242, 255, 0.3)",c.target.style.boxShadow="none"}})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#a0f0ff"},children:"Localisation"}),n.jsx("input",{type:"text",value:e.location,onChange:c=>t({...e,location:c.target.value}),placeholder:"Votre ville",style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"8px",color:"#fff",fontSize:"14px",transition:"all 0.3s ease",outline:"none"},onFocus:c=>{c.target.style.border="1px solid rgba(62, 242, 255, 0.6)",c.target.style.boxShadow="0 0 0 3px rgba(62, 242, 255, 0.1)"},onBlur:c=>{c.target.style.border="1px solid rgba(62, 242, 255, 0.3)",c.target.style.boxShadow="none"}})]})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",color:"#a0f0ff"},children:"Site web"}),n.jsx("input",{type:"url",value:e.website,onChange:c=>t({...e,website:c.target.value}),placeholder:"https://votre-site.com",style:{width:"100%",padding:"12px 16px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"8px",color:"#fff",fontSize:"14px",transition:"all 0.3s ease",outline:"none"},onFocus:c=>{c.target.style.border="1px solid rgba(62, 242, 255, 0.6)",c.target.style.boxShadow="0 0 0 3px rgba(62, 242, 255, 0.1)"},onBlur:c=>{c.target.style.border="1px solid rgba(62, 242, 255, 0.3)",c.target.style.boxShadow="none"}})]}),n.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"16px"},children:[n.jsx("button",{type:"submit",disabled:s,style:{flex:1,padding:"14px 24px",background:"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)",border:"none",borderRadius:"8px",color:"#fff",cursor:s?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold",opacity:s?.6:1,transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(28, 198, 255, 0.3)"},onMouseEnter:c=>{s||(c.target.style.transform="translateY(-1px)",c.target.style.boxShadow="0 4px 12px rgba(28, 198, 255, 0.4)")},onMouseLeave:c=>{c.target.style.transform="translateY(0)",c.target.style.boxShadow="0 2px 8px rgba(28, 198, 255, 0.3)"},children:s?"Sauvegarde...":"Sauvegarder"}),n.jsx("button",{type:"button",onClick:()=>m("/chat"),style:{flex:1,padding:"14px 24px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.3s ease"},onMouseEnter:c=>{c.target.style.background="rgba(255, 255, 255, 0.15)"},onMouseLeave:c=>{c.target.style.background="rgba(255, 255, 255, 0.1)"},children:"Annuler"})]})]})]})]}),l&&n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(5px)"},children:n.jsxs("div",{style:{background:"linear-gradient(135deg, #23234a 0%, #181828 100%)",padding:"28px",borderRadius:"16px",width:"500px",border:"1px solid rgba(62, 242, 255, 0.3)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},children:[n.jsx("h3",{style:{margin:"0 0 20px 0",fontSize:"20px",fontWeight:"bold",color:"#3ef2ff"},children:"Choisir un avatar"}),n.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px",marginBottom:"20px"},children:C.map((c,_)=>n.jsx("div",{onClick:()=>b(c),style:{width:"80px",height:"80px",borderRadius:"50%",background:"linear-gradient(135deg, #1cc6ff 0%, #009fff 100%)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",border:d===c?"3px solid #3ef2ff":"2px solid rgba(62, 242, 255, 0.3)",transition:"all 0.3s ease",overflow:"hidden"},onMouseEnter:E=>{E.target.style.transform="scale(1.05)"},onMouseLeave:E=>{E.target.style.transform="scale(1)"},children:n.jsx("img",{src:c,alt:`Avatar ${_+1}`,style:{width:"100%",height:"100%",objectFit:"cover"}})},_))}),n.jsxs("div",{style:{display:"flex",gap:"12px"},children:[n.jsx("button",{onClick:()=>{d&&(t({...e,avatar:d}),f(!1),b(""))},disabled:!d,style:{flex:1,padding:"12px 20px",background:"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)",border:"none",borderRadius:"8px",color:"#fff",cursor:d?"pointer":"not-allowed",fontSize:"14px",fontWeight:"600",opacity:d?1:.6,transition:"all 0.3s ease"},children:"Confirmer"}),n.jsx("button",{onClick:()=>{f(!1),b("")},style:{flex:1,padding:"12px 20px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"14px",fontWeight:"600",transition:"all 0.3s ease"},children:"Annuler"})]})]})})]})}const rr=console.warn;console.warn=(...e)=>{const t=e[0];typeof t=="string"&&(t.includes("React Router Future Flag Warning")||t.includes("v7_startTransition")||t.includes("v7_relativeSplatPath"))||rr.apply(console,e)};function or({children:e}){return n.jsx(rt,{children:e})}function sr(){const[e,t]=g.useState(null),[r,o]=g.useState(!1),[s,i]=g.useState(!1),{showToast:l}=X();g.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches){i(!0);return}const d=x=>{x.preventDefault(),t(x),o(!0)},b=()=>{i(!0),o(!1),l({message:"Application installée avec succès !",severity:"success"})};return window.addEventListener("beforeinstallprompt",d),window.addEventListener("appinstalled",b),()=>{window.removeEventListener("beforeinstallprompt",d),window.removeEventListener("appinstalled",b)}},[l]);const f=async()=>{if(!e)return;e.prompt();const{outcome:d}=await e.userChoice;l(d==="accepted"?{message:"Installation en cours...",severity:"info"}:{message:"Installation annulée",severity:"warning"}),t(null),o(!1)};return s||!r?null:n.jsx("div",{style:{position:"fixed",bottom:20,left:20,right:20,background:"linear-gradient(135deg, #23234a 0%, #181828 100%)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:16,padding:16,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)",zIndex:1e3,animation:"slideInUp 0.3s ease"},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:16},children:[n.jsxs("div",{style:{flex:1},children:[n.jsx("div",{style:{fontSize:16,fontWeight:600,color:"#fff",marginBottom:4},children:"📱 Installer Chat-changing"}),n.jsx("div",{style:{fontSize:14,color:"#a0f0ff",opacity:.8},children:"Accédez rapidement à votre messagerie"})]}),n.jsxs("div",{style:{display:"flex",gap:8},children:[n.jsx("button",{onClick:f,style:{padding:"8px 16px",background:"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)",border:"none",borderRadius:8,color:"#fff",fontSize:14,fontWeight:600,cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(28, 198, 255, 0.3)"},onMouseEnter:d=>{d.target.style.transform="translateY(-1px)",d.target.style.boxShadow="0 4px 12px rgba(28, 198, 255, 0.4)"},onMouseLeave:d=>{d.target.style.transform="translateY(0)",d.target.style.boxShadow="0 2px 8px rgba(28, 198, 255, 0.3)"},children:"Installer"}),n.jsx("button",{onClick:()=>o(!1),style:{padding:"8px 12px",background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(62, 242, 255, 0.3)",borderRadius:8,color:"#fff",fontSize:14,cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:d=>{d.target.style.background="rgba(255, 255, 255, 0.15)"},onMouseLeave:d=>{d.target.style.background="rgba(255, 255, 255, 0.1)"},children:"✕"})]})]})})}class ir extends We.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return t.message&&(t.message.includes("removeChild")||t.message.includes("DOMNodeInsertedIntoDocument")||t.message.includes("MutationObserver"))?{hasError:!1,error:null}:{hasError:!0,error:t}}componentDidCatch(t,r){!t.message.includes("removeChild")&&!t.message.includes("DOMNodeInsertedIntoDocument")&&!t.message.includes("MutationObserver")&&console.error("Erreur critique capturée:",t,r)}render(){return this.state.hasError?n.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #23234a 0%, #181828 100%)",color:"#fff",textAlign:"center",padding:"20px"},children:n.jsxs("div",{children:[n.jsx("h1",{style:{color:"#ff4757",marginBottom:"16px"},children:"⚠️ Erreur Critique"}),n.jsx("p",{style:{marginBottom:"20px"},children:"Une erreur critique s'est produite. Veuillez rafraîchir la page."}),n.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"12px 24px",background:"linear-gradient(90deg, #1cc6ff 0%, #009fff 100%)",border:"none",borderRadius:"8px",color:"#fff",cursor:"pointer",fontSize:"16px",fontWeight:"600"},children:"Rafraîchir"})]})}):this.props.children}}function ar(){return g.useEffect(()=>{const e=r=>{if(r.error&&r.error.message&&(r.error.message.includes("removeChild")||r.error.message.includes("DOMNodeInsertedIntoDocument")||r.error.message.includes("MutationObserver")||r.error.message.includes("Deprecation"))){r.preventDefault();return}r.error&&!r.error.message.includes("400")&&console.error("Erreur globale:",r.error),r.preventDefault()},t=r=>{if(r.reason&&r.reason.message&&r.reason.message.includes("400")){r.preventDefault();return}console.error("Promesse rejetée non gérée:",r.reason),r.preventDefault()};return window.addEventListener("error",e),window.addEventListener("unhandledrejection",t),()=>{window.removeEventListener("error",e),window.removeEventListener("unhandledrejection",t)}},[]),n.jsx(ir,{children:n.jsx(Dt,{children:n.jsxs(or,{children:[n.jsxs(ot,{children:[n.jsx(K,{path:"/",element:n.jsx(Wt,{})}),n.jsx(K,{path:"/login",element:n.jsx(Te,{mode:"login"})}),n.jsx(K,{path:"/register",element:n.jsx(Te,{mode:"register"})}),n.jsx(K,{path:"/chat",element:n.jsx(tr,{})}),n.jsx(K,{path:"/profile",element:n.jsx(nr,{})}),n.jsx(K,{path:"*",element:n.jsx(st,{to:"/"})})]}),n.jsx(sr,{})]})})})}function lr(){const e=console.warn,t=console.error;console.warn=(...r)=>{const o=r[0];typeof o=="string"&&(o.includes("DOMNodeInsertedIntoDocument")||o.includes("DOM Mutation Event")||o.includes("MutationObserver")||o.includes("React Router Future Flag Warning")||o.includes("v7_startTransition")||o.includes("v7_relativeSplatPath"))||e.apply(console,r)},console.error=(...r)=>{const o=r[0];typeof o=="string"&&(o.includes("removeChild")||o.includes("DOMNodeInsertedIntoDocument")||o.includes("400"))||t.apply(console,r)}}lr();At.createRoot(document.getElementById("root")).render(n.jsx(We.StrictMode,{children:n.jsx(ar,{})}));
