const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CyberpunkAuth-DvTQhB0S.js","assets/vendor-a6qBUclc.js","assets/firebase-RRjfnXea.js","assets/router-C7lAJRjs.js","assets/ui-Br0gaIZz.js","assets/query-BUSDR-nQ.js","assets/virtual-B5fKm2wJ.js","assets/utils-CkSu2hCt.js","assets/error-Dgluv6q7.js","assets/toast-CDmHSc_R.js","assets/state-PH8LGC8A.js","assets/ChatPage-D52Y9EvS.js","assets/Home-BgFsl2kV.js","assets/ErrorFallback-Bo3ZNcPB.js","assets/PWAInstall-DXIGOlx2.js","assets/PerformanceMonitor-DceP6el7.js"])))=>i.map(i=>d[i]);
var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(t,s,r)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r,i=(e,t)=>{for(var s in t||(t={}))a.call(t,s)&&o(e,s,t[s]);if(r)for(var s of r(t))n.call(t,s)&&o(e,s,t[s]);return e},c=(e,r)=>t(e,s(r)),d=(e,t,s)=>new Promise((r,a)=>{var n=e=>{try{i(s.next(e))}catch(t){a(t)}},o=e=>{try{i(s.throw(e))}catch(t){a(t)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(n,o);i((s=s.apply(e,t)).next())});import{c as l,r as u,a as h}from"./vendor-a6qBUclc.js";import{B as m}from"./router-C7lAJRjs.js";import{Q as p,a as f}from"./query-BUSDR-nQ.js";import{E as g}from"./error-Dgluv6q7.js";import{V as y}from"./toast-CDmHSc_R.js";import{p as w,c as v}from"./state-PH8LGC8A.js";import{g as b,i as S,a as E,b as x,c as k,d as A,e as C,f as O,u as R,h as M,j,q as L,w as I,k as z,l as P,o as T,m as D,s as N,n as U}from"./firebase-RRjfnXea.js";import"./virtual-B5fKm2wJ.js";import"./utils-CkSu2hCt.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var _={},W=l;_.createRoot=W.createRoot,_.hydrateRoot=W.hydrateRoot;const $={},q=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),s=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));r=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in $)return;$[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script"),a.crossOrigin="",a.href=e,s&&a.setAttribute("nonce",s),document.head.appendChild(a),t?new Promise((t,s)=>{a.addEventListener("load",t),a.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)})},B=e=>(t,s,r)=>(r.setState=(e,s,...r)=>{const a="function"==typeof e?w(e):e;return t(a,s,...r)},e(r.setState,s,r)),F=e=>(t,s,r)=>{const a=r.subscribe;return r.subscribe=(e,t,s)=>{let n=e;if(t){const a=(null==s?void 0:s.equalityFn)||Object.is;let o=e(r.getState());n=s=>{const r=e(s);if(!a(o,r)){const e=o;t(o=r,e)}},(null==s?void 0:s.fireImmediately)&&t(o,o)}return a(n)},e(t,s,r)};function H(e,t){let s;try{s=e()}catch(r){return}return{getItem:e=>{var t;const r=e=>null===e?null:JSON.parse(e,void 0),a=null!=(t=s.getItem(e))?t:null;return a instanceof Promise?a.then(r):r(a)},setItem:(e,t)=>s.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>s.removeItem(e)}}const V=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then:e=>V(e)(s),catch(e){return this}}}catch(s){return{then(e){return this},catch:e=>V(e)(s)}}},J={apiKey:"AIzaSyDW3ze_OVVjr5I79e0zqDbvnOUi2YRnPFA",authDomain:"chat-changing.firebaseapp.com",projectId:"chat-changing",storageBucket:"chat-changing.appspot.com",messagingSenderId:"38586122759",appId:"1:38586122759:web:07e8309564df8ce71aa0a2",measurementId:"G-NTW1DN98K3"};let G;try{G=0===b().length?S(J):E()}catch(Ve){throw new Error("Impossible d'initialiser Firebase")}const K=x(G),Y=k(G,{cacheSizeBytes:52428800,experimentalForceLongPolling:!0,useFetchStreams:!1});A(G),K.useDeviceLanguage(),C(Y).catch(e=>{"failed-precondition"===e.code||e.code});const Q=v(F((X=B((e,t)=>({user:null,isAuthenticated:!1,users:[],contacts:[],searchResults:[],theme:"dark",sidebarOpen:!1,mobileMenuOpen:!1,chats:[],activeChat:null,unreadCount:0,messages:{},messageCache:{},notifications:[],notificationSettings:{sound:!0,vibration:!0,desktop:!0},performance:{lastRender:0,memoryUsage:0,networkStatus:"online"},errors:[],deviceInfo:{type:"desktop",orientation:"portrait",breakpoint:"lg",dimensions:{width:0,height:0},isTouch:!1,isRetina:!1,isLowBandwidth:!1},setUser:s=>{e(e=>{e.user=s,e.isAuthenticated=!!s}),s&&t().reloadContacts()},setUsers:t=>{e(e=>{e.users=t})},initializeTestUsers:()=>d(void 0,null,function*(){try{const s=j(Y,"users"),r=yield z(s),a=[];r.forEach(e=>{a.push(i({uid:e.id},e.data()))}),e(e=>{e.users=a}),D(s,t=>{const s=[];t.forEach(e=>{s.push(i({uid:e.id},e.data()))}),e(e=>{e.users=s})});const n=t().user;if(n){yield t().reloadContacts();const e=j(Y,"contacts"),s=L(e,I("addedBy","==",n.uid));D(s,e=>d(void 0,null,function*(){yield t().reloadContacts()}))}const o=j(Y,"chats"),c=yield z(o),l=[];c.forEach(e=>{l.push(i({id:e.id},e.data()))}),e(e=>{e.chats=l}),D(o,s=>d(void 0,null,function*(){const r=[];s.forEach(e=>{r.push(i({id:e.id},e.data()))}),e(e=>{e.chats=r}),t().user&&(yield t().reloadContacts())}))}catch(Ve){e(e=>{e.users=[{uid:"user1",displayName:"Alice Cyber",email:"alice@cyberpunk.com",photoURL:null},{uid:"user2",displayName:"Bob Neon",email:"bob@cyberpunk.com",photoURL:null},{uid:"user3",displayName:"Charlie Matrix",email:"charlie@cyberpunk.com",photoURL:null},{uid:"user4",displayName:"Diana Glitch",email:"diana@cyberpunk.com",photoURL:null}]})}}),addUser:s=>d(void 0,null,function*(){try{const e=t().user;if(s.uid===(null==e?void 0:e.uid))return;yield N(O(Y,"users",s.uid),{displayName:s.displayName||"Utilisateur",email:s.email,photoURL:s.photoURL,createdAt:Date.now()})}catch(Ve){e(e=>{e.users.find(e=>e.uid===s.uid)||e.users.push(c(i({},s),{displayName:s.displayName||"Utilisateur"}))})}}),setContacts:t=>{e(e=>{e.contacts=t})},addContact:s=>d(void 0,null,function*(){try{const e=t().user;if(s.uid===(null==e?void 0:e.uid))return void(window.showError&&window.showError("Vous ne pouvez pas vous ajouter vous-mÃªme"));yield N(O(Y,"contacts",`${s.uid}_${Date.now()}`),{uid:s.uid,displayName:s.displayName||"Utilisateur",email:s.email,photoURL:s.photoURL,addedAt:s.addedAt||Date.now(),addedBy:null==e?void 0:e.uid,autoAdded:s.autoAdded||!1}),window.showContactAdded&&window.showContactAdded(s.displayName)}catch(Ve){window.showError&&window.showError("Erreur lors de l'ajout du contact"),e(e=>{e.contacts.find(e=>e.uid===s.uid)||e.contacts.push(c(i({},s),{autoAdded:s.autoAdded||!1}))})}}),removeContact:t=>d(void 0,null,function*(){try{const e=j(Y,"contacts"),s=L(e,I("uid","==",t));(yield z(s)).forEach(e=>d(void 0,null,function*(){yield M(e.ref)}))}catch(Ve){e(e=>{e.contacts=e.contacts.filter(e=>e.uid!==t)})}}),setSearchResults:t=>{e(e=>{e.searchResults=t})},clearSearchResults:()=>{e(e=>{e.searchResults=[]})},createChat:t=>d(void 0,null,function*(){try{return(yield U(j(Y,"chats"),{participants:t,createdAt:Date.now(),lastMessage:null,unreadCount:0})).id}catch(Ve){const r=`chat_${Date.now()}`;return e(e=>{const s={id:r,participants:t,createdAt:Date.now(),lastMessage:null,unreadCount:0};e.chats.unshift(s)}),r}}),setTheme:t=>{e(e=>{e.theme=t,document.documentElement.setAttribute("data-theme",t)})},toggleSidebar:()=>{e(e=>{e.sidebarOpen=!e.sidebarOpen})},toggleMobileMenu:()=>{e(e=>{e.mobileMenuOpen=!e.mobileMenuOpen})},setChats:t=>{e(e=>{e.chats=t})},addChat:t=>{e(e=>{e.chats.unshift(t)})},updateChat:(t,s)=>{e(e=>{const r=e.chats.findIndex(e=>e.id===t);-1!==r&&(e.chats[r]=i(i({},e.chats[r]),s))})},removeChat:t=>{e(e=>{e.chats=e.chats.filter(e=>e.id!==t)})},setActiveChat:t=>{e(e=>{e.activeChat=t})},setUnreadCount:t=>{e(e=>{e.unreadCount=t})},addMessage:(s,r)=>d(void 0,null,function*(){try{const e={content:r.content,senderId:r.senderId,timestamp:r.timestamp,type:r.type||"text",status:"sent",edited:!1,replyTo:r.replyTo||null,attachments:r.attachments||[],reactions:r.reactions||[]};yield U(j(Y,"chats",s,"messages"),e),window.showMessageSent&&window.showMessageSent();const a=t().user,n=t().chats.find(e=>e.id===s);n&&a&&n.participants.filter(e=>e!==a.uid).forEach(e=>d(void 0,null,function*(){yield t().autoAddToContacts(e,s)}))}catch(Ve){e(e=>{e.messages[s]||(e.messages[s]=[]),e.messages[s].push(c(i({},r),{status:"sent",edited:!1,replyTo:r.replyTo||null,attachments:r.attachments||[],reactions:r.reactions||[]}));const t=e.chats.findIndex(e=>e.id===s);-1!==t&&(e.chats[t].lastMessage=r,e.chats[t].lastMessageTime=r.timestamp,e.chats[t].unreadCount=(e.chats[t].unreadCount||0)+1)})}}),reloadContacts:()=>d(void 0,null,function*(){try{const s=t().user;if(!s)return;const r=j(Y,"contacts"),a=L(r,I("addedBy","==",s.uid)),n=yield z(a),o=[];n.forEach(e=>{o.push({uid:e.data().uid,displayName:e.data().displayName||"Utilisateur",email:e.data().email,photoURL:e.data().photoURL,addedAt:e.data().addedAt,autoAdded:e.data().autoAdded||!1,source:"explicit"})});const c=j(Y,"chats"),d=L(c,I("participants","array-contains",s.uid)),l=yield z(d),u=[],h=j(Y,"users"),m=yield z(h),p=new Map;m.forEach(e=>{p.set(e.id,i({uid:e.id},e.data()))}),l.forEach(e=>{const t=e.data(),r=t.participants.find(e=>e!==s.uid);if(r&&p.has(r)){const s=p.get(r);u.push({uid:r,displayName:s.displayName||"Utilisateur",email:s.email,photoURL:s.photoURL,addedAt:t.createdAt||Date.now(),autoAdded:!1,source:"chat",chatId:e.id})}});const f=[...o,...u].reduce((e,t)=>{const s=e.find(e=>e.uid===t.uid);return s&&"explicit"!==t.source||(s&&(e=e.filter(e=>e.uid!==t.uid)),e.push(t)),e},[]);e(e=>{e.contacts=f})}catch(Ve){}}),autoAddToContacts:(e,s)=>d(void 0,null,function*(){try{const s=t().user;if(!s||e===s.uid)return;if(t().contacts.find(t=>t.uid===e))return;const r=yield z(L(j(Y,"users"),I("uid","==",e)));if(!r.empty){const t=r.docs[0].data();yield N(O(Y,"contacts",`${e}_${Date.now()}`),{uid:e,displayName:t.displayName||"Utilisateur",email:t.email,photoURL:t.photoURL,addedAt:Date.now(),addedBy:s.uid,autoAdded:!0}),window.showContactAutoAdded&&window.showContactAutoAdded(t.displayName)}}catch(Ve){window.showError&&window.showError("Erreur lors de l'ajout automatique aux contacts")}}),loadChatMessages:s=>d(void 0,null,function*(){try{const r=j(Y,"chats",s,"messages"),a=L(r,T("timestamp","asc")),n=yield z(a),o=[];n.forEach(e=>{o.push(i({id:e.id},e.data()))}),e(e=>{e.messages[s]=o}),D(a,r=>{const a=[];r.forEach(e=>{a.push(i({id:e.id},e.data()))}),e(e=>{e.messages[s]=a});const n=t().user;if(n&&a.length>0){const e=a[a.length-1];e.senderId!==n.uid&&t().autoAddToContacts(e.senderId,s).catch(e=>{})}})}catch(Ve){}}),markMessagesAsRead:t=>d(void 0,null,function*(){try{const s=j(Y,"chats",t,"messages"),r=L(s,I("status","==","delivered")),a=yield z(r),n=P(Y);a.forEach(e=>{n.update(e.ref,{status:"read"})}),yield n.commit(),e(e=>{e.messages[t]&&e.messages[t].forEach(e=>{"delivered"===e.status&&(e.status="read")});const s=e.chats.findIndex(e=>e.id===t);-1!==s&&(e.chats[s].unreadCount=0)})}catch(Ve){}}),editMessage:(t,s,r)=>d(void 0,null,function*(){try{const e=O(Y,"chats",t,"messages",s);yield R(e,{content:r,edited:!0,editedAt:Date.now()})}catch(Ve){e(e=>{if(e.messages[t]){const a=e.messages[t].findIndex(e=>e.id===s);-1!==a&&(e.messages[t][a].content=r,e.messages[t][a].edited=!0,e.messages[t][a].editedAt=Date.now())}})}}),deleteMessage:(t,s)=>d(void 0,null,function*(){try{yield M(O(Y,"chats",t,"messages",s))}catch(Ve){e(e=>{e.messages[t]&&(e.messages[t]=e.messages[t].filter(e=>e.id!==s))})}}),addReaction:(t,s,r)=>d(void 0,null,function*(){try{const e=O(Y,"chats",t,"messages",s);yield R(e,{[`reactions.${r.userId}`]:r.emoji})}catch(Ve){e(e=>{if(e.messages[t]){const a=e.messages[t].findIndex(e=>e.id===s);-1!==a&&(e.messages[t][a].reactions||(e.messages[t][a].reactions={}),e.messages[t][a].reactions[r.userId]=r.emoji)}})}}),updateMessage:(t,s,r)=>{e(e=>{if(e.messages[t]){const a=e.messages[t].findIndex(e=>e.id===s);-1!==a&&(e.messages[t][a]=i(i({},e.messages[t][a]),r))}})},removeMessage:(t,s)=>{e(e=>{e.messages[t]&&(e.messages[t]=e.messages[t].filter(e=>e.id!==s))})},setMessages:(t,s)=>{e(e=>{e.messages[t]=s})},addNotification:t=>{e(e=>{e.notifications.unshift(i({id:Date.now(),timestamp:Date.now()},t)),e.notifications.length>50&&(e.notifications=e.notifications.slice(0,50))})},removeNotification:t=>{e(e=>{e.notifications=e.notifications.filter(e=>e.id!==t)})},clearNotifications:()=>{e(e=>{e.notifications=[]})},updateNotificationSettings:t=>{e(e=>{e.notificationSettings=i(i({},e.notificationSettings),t)})},setPerformance:t=>{e(e=>{e.performance=i(i({},e.performance),t)})},setDeviceInfo:t=>{e(e=>{e.deviceInfo=i(i({},e.deviceInfo),t)})},addError:t=>{e(e=>{e.errors.unshift({id:Date.now(),message:t.message,stack:t.stack,timestamp:Date.now()}),e.errors.length>10&&(e.errors=e.errors.slice(0,10))})},clearErrors:()=>{e(e=>{e.errors=[]})},clearChatData:()=>{e(e=>{e.chats=[],e.messages={},e.activeChat=null,e.unreadCount=0})},logout:()=>{e(e=>{e.user=null,e.isAuthenticated=!1,e.chats=[],e.messages={},e.activeChat=null,e.unreadCount=0,e.notifications=[],e.errors=[]})},initializeApp:()=>d(void 0,null,function*(){try{const t=localStorage.getItem("theme")||"dark";e(e=>{e.theme=t});const s=localStorage.getItem("user");if(s)try{const t=JSON.parse(s);e(e=>{e.user=t,e.isAuthenticated=!!t})}catch(Ve){localStorage.removeItem("user")}return!0}catch(Ve){return!1}})})),"getStorage"in(Z={name:"cirus-chat-store",storage:H(()=>localStorage),partialize:e=>({theme:e.theme,notificationSettings:e.notificationSettings})})||"serialize"in Z||"deserialize"in Z?((e,t)=>(s,r,a)=>{let n=i({getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:e=>e,version:0,merge:(e,t)=>i(i({},t),e)},t),o=!1;const c=new Set,d=new Set;let l;try{l=n.getStorage()}catch(y){}if(!l)return e((...e)=>{s(...e)},r,a);const u=V(n.serialize),h=()=>{const e=n.partialize(i({},r()));let t;const s=u({state:e,version:n.version}).then(e=>l.setItem(n.name,e)).catch(e=>{t=e});if(t)throw t;return s},m=a.setState;a.setState=(e,t)=>{m(e,t),h()};const p=e((...e)=>{s(...e),h()},r,a);let f;const g=()=>{var e;if(!l)return;o=!1,c.forEach(e=>e(r()));const t=(null==(e=n.onRehydrateStorage)?void 0:e.call(n,r()))||void 0;return V(l.getItem.bind(l))(n.name).then(e=>{if(e)return n.deserialize(e)}).then(e=>{if(e){if("number"!=typeof e.version||e.version===n.version)return e.state;if(n.migrate)return n.migrate(e.state,e.version)}}).then(e=>{var t;return f=n.merge(e,null!=(t=r())?t:p),s(f,!0),h()}).then(()=>{null==t||t(f,void 0),o=!0,d.forEach(e=>e(f))}).catch(e=>{null==t||t(void 0,e)})};return a.persist={setOptions:e=>{n=i(i({},n),e),e.getStorage&&(l=e.getStorage())},clearStorage:()=>{null==l||l.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>g(),hasHydrated:()=>o,onHydrate:e=>(c.add(e),()=>{c.delete(e)}),onFinishHydration:e=>(d.add(e),()=>{d.delete(e)})},g(),f||p})(X,Z):((e,t)=>(s,r,a)=>{let n=i({storage:H(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>i(i({},t),e)},t),o=!1;const c=new Set,d=new Set;let l=n.storage;if(!l)return e((...e)=>{s(...e)},r,a);const u=()=>{const e=n.partialize(i({},r()));return l.setItem(n.name,{state:e,version:n.version})},h=a.setState;a.setState=(e,t)=>{h(e,t),u()};const m=e((...e)=>{s(...e),u()},r,a);let p;a.getInitialState=()=>m;const f=()=>{var e,t;if(!l)return;o=!1,c.forEach(e=>{var t;return e(null!=(t=r())?t:m)});const a=(null==(t=n.onRehydrateStorage)?void 0:t.call(n,null!=(e=r())?e:m))||void 0;return V(l.getItem.bind(l))(n.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===n.version)return[!1,e.state];if(n.migrate)return[!0,n.migrate(e.state,e.version)]}return[!1,void 0]}).then(e=>{var t;const[a,o]=e;if(p=n.merge(o,null!=(t=r())?t:m),s(p,!0),a)return u()}).then(()=>{null==a||a(p,void 0),p=r(),o=!0,d.forEach(e=>e(p))}).catch(e=>{null==a||a(void 0,e)})};return a.persist={setOptions:e=>{n=i(i({},n),e),e.storage&&(l=e.storage)},clearStorage:()=>{null==l||l.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>f(),hasHydrated:()=>o,onHydrate:e=>(c.add(e),()=>{c.delete(e)}),onFinishHydration:e=>(d.add(e),()=>{d.delete(e)})},n.skipHydration||f(),p||m})(X,Z))));var X,Z;v(F(B((e,t)=>({metrics:{fps:0,memory:0,domNodes:0,loadTime:0,renderTime:0},setMetrics:t=>{e(e=>{e.metrics=i(i({},e.metrics),t)})},updateFPS:t=>{e(e=>{e.metrics.fps=t})},updateMemory:t=>{e(e=>{e.metrics.memory=t})},updateDOMNodes:t=>{e(e=>{e.metrics.domNodes=t})},updateLoadTime:t=>{e(e=>{e.metrics.loadTime=t})},updateRenderTime:t=>{e(e=>{e.metrics.renderTime=t})},resetMetrics:()=>{e(e=>{e.metrics={fps:0,memory:0,domNodes:0,loadTime:0,renderTime:0}})}})))),v(F(B((e,t)=>({securityStatus:{blocked:!1,reason:null,attempts:0,lastAttempt:0},setSecurityStatus:t=>{e(e=>{e.securityStatus=i(i({},e.securityStatus),t)})},incrementAttempts:()=>{e(e=>{e.securityStatus.attempts+=1,e.securityStatus.lastAttempt=Date.now()})},resetAttempts:()=>{e(e=>{e.securityStatus.attempts=0,e.securityStatus.lastAttempt=0})},blockUser:t=>{e(e=>{e.securityStatus.blocked=!0,e.securityStatus.reason=t})},unblockUser:()=>{e(e=>{e.securityStatus.blocked=!1,e.securityStatus.reason=null})}}))));var ee={exports:{}},te={},se=u,re=Symbol.for("react.element"),ae=Symbol.for("react.fragment"),ne=Object.prototype.hasOwnProperty,oe=se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ie={key:!0,ref:!0,__self:!0,__source:!0};function ce(e,t,s){var r,a={},n=null,o=null;for(r in void 0!==s&&(n=""+s),void 0!==t.key&&(n=""+t.key),void 0!==t.ref&&(o=t.ref),t)ne.call(t,r)&&!ie.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:re,type:e,key:n,ref:o,props:a,_owner:oe.current}}te.Fragment=ae,te.jsx=ce,te.jsxs=ce,ee.exports=te;var de=ee.exports;const le=u.createContext(),ue=()=>{const e=u.useContext(le);if(!e)throw new Error("useToast must be used within a ToastProvider");return e},he=({children:e})=>{const t=(e,t="default")=>{switch(t){case"success":y.success(e,{duration:4e3,style:{background:"#00d4ff",color:"#000",border:"1px solid #00d4ff",borderRadius:"8px",fontSize:"14px",fontWeight:"500"}});break;case"error":y.error(e,{duration:5e3,style:{background:"#ff4757",color:"#fff",border:"1px solid #ff4757",borderRadius:"8px",fontSize:"14px",fontWeight:"500"}});break;case"loading":y.loading(e,{style:{background:"#ffa502",color:"#000",border:"1px solid #ffa502",borderRadius:"8px",fontSize:"14px",fontWeight:"500"}});break;case"info":y(e,{duration:3e3,style:{background:"#3742fa",color:"#fff",border:"1px solid #3742fa",borderRadius:"8px",fontSize:"14px",fontWeight:"500"}});break;case"auto-added":y.success(e,{duration:6e3,icon:"â¨",style:{background:"linear-gradient(135deg, #ff6b35 0%, #f7931e 100%)",color:"#fff",border:"1px solid #ff6b35",borderRadius:"8px",fontSize:"14px",fontWeight:"500",boxShadow:"0 4px 12px rgba(255, 107, 53, 0.3)"}});break;default:y(e,{duration:3e3,style:{background:"#2f3542",color:"#fff",border:"1px solid #2f3542",borderRadius:"8px",fontSize:"14px",fontWeight:"500"}})}},s={showToast:t,showContactAdded:e=>{t(`â ${e} ajoutÃ© Ã  vos contacts`,"success")},showContactAutoAdded:e=>{t(`â¨ ${e} ajoutÃ© automatiquement Ã  vos contacts`,"auto-added")},showMessageSent:()=>{t("ğ¤ Message envoyÃ©","success")},showMessageReceived:e=>{t(`ğ¥ Nouveau message de ${e}`,"info")},showError:e=>{t(`â ${e}`,"error")},showLoading:e=>{t(e,"loading")}};return de.jsx(le.Provider,{value:s,children:e})},me=()=>{const{showContactAdded:e,showContactAutoAdded:t,showMessageSent:s,showMessageReceived:r,showError:a,showLoading:n,showToast:o}=ue();return u.useEffect(()=>(window.showContactAdded=e,window.showContactAutoAdded=t,window.showMessageSent=s,window.showMessageReceived=r,window.showError=a,window.showLoading=n,window.showToast=o,()=>{delete window.showContactAdded,delete window.showContactAutoAdded,delete window.showMessageSent,delete window.showMessageReceived,delete window.showError,delete window.showLoading,delete window.showToast}),[e,t,s,r,a,n,o]),null},pe=new class{constructor(){this.metrics={pageLoadTime:0,firstContentfulPaint:0,largestContentfulPaint:0,cumulativeLayoutShift:0,firstInputDelay:0,memoryUsage:null},this.observers=[],this.isMonitoring=!1}start(){this.isMonitoring||(this.isMonitoring=!0,this.observeWebVitals(),this.observeMemoryUsage(),this.logInitialMetrics())}stop(){this.isMonitoring=!1,this.observers.forEach(e=>e.disconnect()),this.observers=[]}observeWebVitals(){if("PerformanceObserver"in window){const e=new PerformanceObserver(e=>{const t=e.getEntries(),s=t[t.length-1];this.metrics.firstContentfulPaint=s.startTime,this.logMetric("FCP",s.startTime)});e.observe({entryTypes:["paint"]}),this.observers.push(e);const t=new PerformanceObserver(e=>{const t=e.getEntries(),s=t[t.length-1];this.metrics.largestContentfulPaint=s.startTime,this.logMetric("LCP",s.startTime)});t.observe({entryTypes:["largest-contentful-paint"]}),this.observers.push(t);const s=new PerformanceObserver(e=>{let t=0;for(const s of e.getEntries())s.hadRecentInput||(t+=s.value);this.metrics.cumulativeLayoutShift=t,this.logMetric("CLS",t)});s.observe({entryTypes:["layout-shift"]}),this.observers.push(s);const r=new PerformanceObserver(e=>{const t=e.getEntries(),s=t[t.length-1];this.metrics.firstInputDelay=s.processingStart-s.startTime,this.logMetric("FID",this.metrics.firstInputDelay)});r.observe({entryTypes:["first-input"]}),this.observers.push(r)}}observeMemoryUsage(){"memory"in performance&&setInterval(()=>{this.metrics.memoryUsage={used:performance.memory.usedJSHeapSize,total:performance.memory.totalJSHeapSize,limit:performance.memory.jsHeapSizeLimit},this.metrics.memoryUsage.used,this.metrics.memoryUsage.limit},5e3)}logInitialMetrics(){window.addEventListener("load",()=>{const e=performance.now();this.metrics.pageLoadTime=e,this.logMetric("Page Load Time",e)})}logMetric(e,t){}getMetrics(){return i({},this.metrics)}measureFunction(e,t){const s=performance.now(),r=t(),a=performance.now()-s;return this.logMetric(e,a),{result:r,duration:a}}measureAsyncFunction(e,t){return d(this,null,function*(){const s=performance.now(),r=yield t(),a=performance.now()-s;return this.logMetric(e,a),{result:r,duration:a}})}};class fe{constructor(){this.worker=null,this.isSupported="undefined"!=typeof Worker}init(){if(!this.isSupported)return;const e=new Blob(["\n      self.onmessage = function(e) {\n        const { type, data } = e.data;\n        \n        switch(type) {\n          case 'processData':\n            const result = processData(data);\n            self.postMessage({ type: 'result', data: result });\n            break;\n          case 'calculateStats':\n            const stats = calculateStats(data);\n            self.postMessage({ type: 'stats', data: stats });\n            break;\n        }\n      };\n\n      function processData(data) {\n        // Simulation de traitement lourd\n        return data.map(item => ({\n          ...item,\n          processed: true,\n          timestamp: Date.now()\n        }));\n      }\n\n      function calculateStats(data) {\n        return {\n          count: data.length,\n          average: data.reduce((sum, item) => sum + item.value, 0) / data.length,\n          max: Math.max(...data.map(item => item.value)),\n          min: Math.min(...data.map(item => item.value))\n        };\n      }\n    "],{type:"application/javascript"});this.worker=new Worker(URL.createObjectURL(e))}postMessage(e,t){this.worker&&this.worker.postMessage({type:e,data:t})}onMessage(e){this.worker&&(this.worker.onmessage=e)}terminate(){this.worker&&(this.worker.terminate(),this.worker=null)}}class ge{constructor(e=100){this.maxSize=e,this.cache=new Map,this.accessOrder=[]}get(e){return this.cache.has(e)?(this.updateAccessOrder(e),this.cache.get(e)):null}set(e,t){if(this.cache.has(e))this.updateAccessOrder(e);else if(this.accessOrder.push(e),this.accessOrder.length>this.maxSize){const e=this.accessOrder.shift();this.cache.delete(e)}this.cache.set(e,t)}updateAccessOrder(e){const t=this.accessOrder.indexOf(e);t>-1&&(this.accessOrder.splice(t,1),this.accessOrder.push(e))}clear(){this.cache.clear(),this.accessOrder=[]}}class ye{constructor(){this.animations=new Map,this.isRunning=!1}addAnimation(e,t){this.animations.set(e,t),this.isRunning||this.start()}removeAnimation(e){this.animations.delete(e),0===this.animations.size&&this.stop()}start(){this.isRunning=!0,this.animate()}stop(){this.isRunning=!1}animate(){this.isRunning&&(this.animations.forEach(e=>{e()}),requestAnimationFrame(()=>this.animate()))}}class we{constructor(){this.listeners=new Map}addListener(e,t,s){const r=`${e}-${t}`;this.listeners.has(r)||this.listeners.set(r,[]),this.listeners.get(r).push(s)}removeListener(e,t,s){const r=`${e}-${t}`,a=this.listeners.get(r);if(a){const e=a.indexOf(s);e>-1&&a.splice(e,1)}}delegate(e){const{target:t,type:s}=e,r=`${t.tagName.toLowerCase()}-${s}`,a=this.listeners.get(r);a&&a.forEach(t=>{try{t(e)}catch(Ve){}})}}class ve{constructor(){this.pendingRequests=new Map,this.cache=new ge(50)}request(e){return d(this,arguments,function*(e,t={}){const s=`${e}-${JSON.stringify(t)}`,r=this.cache.get(s);if(r&&Date.now()-r.timestamp<3e5)return r.data;if(this.pendingRequests.has(s))return this.pendingRequests.get(s);const a=fetch(e,t).then(e=>{if(!e.ok)throw new Error(`HTTP ${e.status}`);return e.json()}).then(e=>(this.cache.set(s,{data:e,timestamp:Date.now()}),this.pendingRequests.delete(s),e)).catch(e=>{throw this.pendingRequests.delete(s),e});return this.pendingRequests.set(s,a),a})}}class be{constructor(){this.virtualNodes=new Map,this.observer=null}observe(e,t){this.observer&&this.observer.disconnect(),this.observer=new MutationObserver(e=>{e.forEach(e=>{"childList"===e.type&&t(e)})}),this.observer.observe(e,{childList:!0,subtree:!0})}disconnect(){this.observer&&(this.observer.disconnect(),this.observer=null)}}class Se{constructor(){this.weakRefs=new Map,this.cleanupInterval=null}trackObject(e,t){this.weakRefs.set(e,new WeakRef(t))}getObject(e){const t=this.weakRefs.get(e);if(t){const s=t.deref();if(s)return s;this.weakRefs.delete(e)}return null}startCleanup(){this.cleanupInterval=setInterval(()=>{this.cleanup()},3e4)}stopCleanup(){this.cleanupInterval&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null)}cleanup(){for(const[e,t]of this.weakRefs.entries())t.deref()||this.weakRefs.delete(e)}}const Ee=new class{constructor(){this.backgroundWorker=new fe,this.animationOptimizer=new ye,this.eventDelegator=new we,this.networkOptimizer=new ve,this.virtualDOMOptimizer=new be,this.memoryOptimizer=new Se}init(){this.backgroundWorker.init(),this.memoryOptimizer.startCleanup(),document.addEventListener("click",e=>this.eventDelegator.delegate(e)),document.addEventListener("scroll",e=>this.eventDelegator.delegate(e))}destroy(){this.backgroundWorker.terminate(),this.animationOptimizer.stop(),this.virtualDOMOptimizer.disconnect(),this.memoryOptimizer.stopCleanup()}};var xe=Object.defineProperty,ke=Object.defineProperties,Ae=Object.getOwnPropertyDescriptors,Ce=Object.getOwnPropertySymbols,Oe=Object.prototype.hasOwnProperty,Re=Object.prototype.propertyIsEnumerable,Me=(e,t,s)=>t in e?xe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,je=(e,t)=>{for(var s in t||(t={}))Oe.call(t,s)&&Me(e,s,t[s]);if(Ce)for(var s of Ce(t))Re.call(t,s)&&Me(e,s,t[s]);return e},Le=(e,t)=>ke(e,Ae(t));const Ie=u.createContext(),ze="DELETE",Pe="CLEAR",Te="UPDATE",De=(e,t)=>{var s,r;switch(t.type){case"SET":return Le(je({},e),{data:Le(je({},e.data),{[t.key]:{value:t.value,timestamp:Date.now(),ttl:t.ttl||3e5}})});case"GET":return e;case ze:const a=e.data,{[s=t.key]:n}=a,o=((e,t)=>{var s={};for(var r in e)Oe.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&Ce)for(var r of Ce(e))t.indexOf(r)<0&&Re.call(e,r)&&(s[r]=e[r]);return s})(a,[(r=s,"symbol"==typeof r?r:r+"")]);return Le(je({},e),{data:o});case Pe:return Le(je({},e),{data:{}});case Te:return Le(je({},e),{data:Le(je({},e.data),{[t.key]:Le(je({},e.data[t.key]),{value:t.value,timestamp:Date.now()})})});default:return e}},Ne=({children:e,maxSize:t=100})=>{const[s,r]=u.useReducer(De,{data:{},lruCache:new ge(t)}),a=u.useCallback(()=>{const e=Date.now();Object.entries(s.data).forEach(([t,s])=>{e-s.timestamp>s.ttl&&r({type:ze,key:t})})},[s.data]);h.useEffect(()=>{const e=setInterval(a,6e4);return()=>clearInterval(e)},[a]);const n={setCache:u.useCallback((e,t,a)=>{r({type:"SET",key:e,value:t,ttl:a}),s.lruCache.set(e,{value:t,timestamp:Date.now(),ttl:a})},[s.lruCache]),getCache:u.useCallback(e=>{const t=s.data[e];return t&&Date.now()-t.timestamp<t.ttl?(r({type:"GET",key:e}),t.value):null},[s.data]),deleteCache:u.useCallback(e=>{r({type:ze,key:e}),s.lruCache.clear()},[s.lruCache]),clearCache:u.useCallback(()=>{r({type:Pe}),s.lruCache.clear()},[s.lruCache]),updateCache:u.useCallback((e,t)=>{r({type:Te,key:e,value:t})},[]),cacheStats:u.useMemo(()=>{const e=Date.now(),t=Object.entries(s.data).filter(([t,s])=>e-s.timestamp<s.ttl);return{totalEntries:Object.keys(s.data).length,validEntries:t.length,expiredEntries:Object.keys(s.data).length-t.length,memoryUsage:JSON.stringify(s.data).length}},[s.data]),cleanupExpired:a};return de.jsx(Ie.Provider,{value:n,children:e})},Ue=()=>/Android/i.test(navigator.userAgent),_e=new class{constructor(){this.isAndroid=Ue(),this.isAndroidChrome=Ue()&&/Chrome/i.test(navigator.userAgent),this.optimizations=new Map}optimizeAnimations(){if(!this.isAndroid)return;const e=document.createElement("style");e.textContent="\n      @media (max-width: 768px) {\n        .motion-div {\n          will-change: auto !important;\n        }\n        \n        .cyberpunk-button {\n          transform: none !important;\n          transition: all 0.2s ease !important;\n        }\n        \n        .neon-text {\n          animation-duration: 2s !important;\n        }\n      }\n    ",document.head.appendChild(e)}optimizeMemory(){if(!this.isAndroid)return;const e=window.setCache;e&&(window.setCache=(t,s,r)=>{const a=Math.min(r||3e5,18e4);return e(t,s,a)}),setInterval(()=>{"memory"in performance&&performance.memory.usedJSHeapSize/performance.memory.jsHeapSizeLimit>.7&&this.forceGarbageCollection()},1e4)}forceGarbageCollection(){window.gc&&window.gc()}optimizeImages(){this.isAndroid&&document.querySelectorAll("img").forEach(e=>{if(e.src&&!e.src.includes("webp")){const t=e.src.replace(/\.(jpg|jpeg|png)/,".webp"),s=new Image;s.onload=()=>{e.src=t},s.onerror=()=>{},s.src=t}})}optimizeScroll(){this.isAndroid&&document.querySelectorAll(".scrollable").forEach(e=>{e.style.webkitOverflowScrolling="touch",e.style.overflowScrolling="touch"})}optimizeTouchEvents(){this.isAndroid&&(document.addEventListener("touchstart",e=>{e.target.classList.contains("btn")&&e.preventDefault()},{passive:!1}),document.addEventListener("touchmove",e=>{},{passive:!0}))}optimizeBattery(){this.isAndroid&&("getBattery"in navigator&&navigator.getBattery().then(e=>{e.level<.2&&this.enableLowPowerMode()}),navigator.getBattery().then(e=>{e.addEventListener("levelchange",()=>{e.level<.2?this.enableLowPowerMode():this.disableLowPowerMode()})}))}enableLowPowerMode(){document.body.classList.add("low-power-mode");const e=document.createElement("style");e.textContent="\n      .low-power-mode * {\n        animation-duration: 0.5s !important;\n        transition-duration: 0.2s !important;\n      }\n      \n      .low-power-mode .neon-text {\n        animation: none !important;\n      }\n    ",document.head.appendChild(e)}disableLowPowerMode(){document.body.classList.remove("low-power-mode")}optimizeNetwork(){this.isAndroid&&"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.active.postMessage({type:"SET_CACHE_STRATEGY",strategy:"cache-first"})})}init(){this.isAndroid&&(this.optimizeAnimations(),this.optimizeMemory(),this.optimizeImages(),this.optimizeScroll(),this.optimizeTouchEvents(),this.optimizeBattery(),this.optimizeNetwork(),this.monitorPerformance())}monitorPerformance(){if(!this.isAndroid)return;let e=0,t=performance.now();const s=()=>{e++;const r=performance.now();if(r-t>=1e3){const s=Math.round(1e3*e/(r-t));s<30?this.enableLowPowerMode():s>50&&this.disableLowPowerMode(),e=0,t=r}requestAnimationFrame(s)};s()}};var We=Math.pow;u.lazy(()=>q(()=>import("./CyberpunkAuth-DvTQhB0S.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),u.lazy(()=>q(()=>import("./ChatPage-D52Y9EvS.js"),__vite__mapDeps([11,1,3,4,5,6,7,8,9,10,2]))),u.lazy(()=>q(()=>import("./Home-BgFsl2kV.js"),__vite__mapDeps([12,1,4,11,3,5,6,7,8,9,10,2,0])));const $e=u.lazy(()=>q(()=>import("./ErrorFallback-Bo3ZNcPB.js"),__vite__mapDeps([13,1,3,5,6,7,8,9,10,2]))),qe=u.lazy(()=>q(()=>import("./PWAInstall-DXIGOlx2.js"),__vite__mapDeps([14,1,4,3,5,6,7,8,9,10,2]))),Be=u.lazy(()=>q(()=>import("./PerformanceMonitor-DceP6el7.js"),__vite__mapDeps([15,1,4,3,5,6,7,8,9,10,2]))),Fe=new p({defaultOptions:{queries:{retry:3,retryDelay:e=>Math.min(1e3*We(2,e),3e4),staleTime:3e5,cacheTime:6e5,refetchOnWindowFocus:!1,refetchOnReconnect:!0},mutations:{retry:1,retryDelay:1e3}}});function He(){const{initializeApp:e,setUser:t,setTheme:s,addError:r,initializeTestUsers:a}=Q();return u.useEffect(()=>{(()=>{return n=this,o=function*(){try{yield e(),a().catch(e=>{}),d(void 0,null,function*(){if("serviceWorker"in navigator)try{const e=yield navigator.serviceWorker.register("/sw.js",{scope:"/"});return e.addEventListener("updatefound",()=>{const t=e.installing;t.addEventListener("statechange",()=>{"installed"===t.state&&navigator.serviceWorker.controller&&confirm("Une nouvelle version est disponible. Voulez-vous recharger la page ?")&&window.location.reload()})}),e.addEventListener("error",e=>{}),e}catch(Ve){return null}return null}).catch(e=>{}),pe.start(),Ee.init(),_e.init();const r=localStorage.getItem("theme")||"dark";s(r),t({uid:"test-user-123",email:"test@cirus.com",displayName:"Utilisateur Test",photoURL:null});const n=K.onAuthStateChanged(e=>{if(e){const s={uid:e.uid,email:e.email,displayName:e.displayName||"Utilisateur",photoURL:e.photoURL};t(s),localStorage.setItem("user",JSON.stringify(s))}else t(null),localStorage.removeItem("user")});return()=>n()}catch(Ve){r(Ve)}},new Promise((e,t)=>{var s=e=>{try{a(o.next(e))}catch(s){t(s)}},r=e=>{try{a(o.throw(e))}catch(s){t(s)}},a=t=>t.done?e(t.value):Promise.resolve(t.value).then(s,r);a((o=o.apply(n,null)).next())});var n,o})()},[e,s,t,r,a]),u.useEffect(()=>{const e=e=>{const t=e.error||new Error("Erreur inconnue");r(t)},t=e=>{const t=new Error(e.reason||"Promesse rejetÃ©e");r(t)};return window.addEventListener("error",e),window.addEventListener("unhandledrejection",t),()=>{window.removeEventListener("error",e),window.removeEventListener("unhandledrejection",t)}},[r]),u.useEffect(()=>()=>{Ee.destroy()},[]),de.jsx(f,{client:Fe,children:de.jsx(Ne,{maxSize:200,children:de.jsx(m,{children:de.jsx(g,{FallbackComponent:$e,onError:(e,t)=>{r(e)},children:de.jsxs(he,{children:[de.jsx(me,{}),de.jsx(qe,{}),de.jsx("div",{style:{background:"linear-gradient(135deg, #000000, #1a1a2e)",minHeight:"100vh",color:"#ffffff",padding:"20px",fontFamily:"Arial, sans-serif"},children:de.jsxs("div",{style:{textAlign:"center",padding:"50px 20px",background:"rgba(255, 0, 255, 0.3)",borderRadius:"20px",border:"3px solid #ff00ff",margin:"20px auto",maxWidth:"600px"},children:[de.jsx("h1",{style:{fontSize:"4rem",color:"#ff00ff",textShadow:"0 0 10px #ff00ff, 0 0 20px #ff00ff, 0 0 30px #ff00ff",marginBottom:"30px"},children:"CIRUS"}),de.jsx("p",{style:{fontSize:"1.5rem",color:"#ffffff",marginBottom:"20px",background:"rgba(0, 255, 255, 0.2)",padding:"15px",borderRadius:"10px"},children:"â Application Fonctionnelle"}),de.jsx("p",{style:{fontSize:"1rem",color:"#ffff00",marginBottom:"20px"},children:"URL: http://192.168.0.103:5173"}),de.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"10px",flexWrap:"wrap"},children:[de.jsx("button",{style:{background:"#ff00ff",color:"#ffffff",padding:"10px 20px",border:"none",borderRadius:"5px",fontSize:"1rem"},children:"Accueil"}),de.jsx("button",{style:{background:"#333",color:"#ffffff",padding:"10px 20px",border:"none",borderRadius:"5px",fontSize:"1rem"},children:"Messages"}),de.jsx("button",{style:{background:"#333",color:"#ffffff",padding:"10px 20px",border:"none",borderRadius:"5px",fontSize:"1rem"},children:"Recherche"})]})]})}),de.jsx(Be,{})]})})})})})}_.createRoot(document.getElementById("root")).render(de.jsx(h.StrictMode,{children:de.jsx(He,{})}));export{ue as a,K as b,Y as d,de as j,Q as u};
